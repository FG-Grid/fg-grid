const e={version:"0.3.9",isTouchDevice:"ontouchstart"in window,gridIdSeed:0,gridsMap:new Map,get(e){return this.gridsMap.get(e)},capitalizeFirstLetter:e=>e.charAt(0).toUpperCase()+e.slice(1),deepClone(t){if(null===t||"object"!=typeof t)return t;if(Array.isArray(t))return t.map((t=>e.deepClone(t)));const o={};for(let r in t)t.hasOwnProperty(r)&&(o[r]=e.deepClone(t[r]));return o}};window.Fancy=window.Fancy||e,Fancy.debounce=(e,t)=>{let o;return function(...r){clearTimeout(o),o=setTimeout((()=>{e.apply(this,r)}),t)}},Fancy.svg={chevronRight:['<svg viewBox="0 0 16 16" style="shape-rendering: geometricprecision;">','<path fill-rule="evenodd" fill="currentColor" d="M5.054 4.524a1.04 1.04 0 0 1 1.47-1.47l4.211 4.211a1.04 1.04 0 0 1 0 1.47l-4.21 4.21a1.04 1.04 0 0 1-1.47-1.47L8.53 8 5.054 4.524z"></path>',"</svg>"].join(""),group:['<svg viewBox="0 0 16 16" style="shape-rendering: geometricprecision;">','<path fill-rule="evenodd" fill="currentColor" d="M1 3.006C1 1.898 1.897 1 3.006 1h9.988C14.102 1 15 1.897 15 3.006v9.988A2.005 2.005 0 0 1 12.994 15H3.006A2.005 2.005 0 0 1 1 12.994V3.006zm2 .99v8.009c0 .54.446.995.995.995h8.01c.54 0 .995-.446.995-.995v-8.01c0-.54-.446-.995-.995-.995h-8.01C3.455 3 3 3.446 3 3.995zM7 6c0-.552.444-1 1-1h3c.552 0 1 .444 1 1 0 .552-.444 1-1 1H8c-.552 0-1-.444-1-1zm0 4c0-.552.444-1 1-1h3c.552 0 1 .444 1 1 0 .552-.444 1-1 1H8c-.552 0-1-.444-1-1zM4 6c0-.552.444-1 1-1 .552 0 1 .444 1 1 0 .552-.444 1-1 1-.552 0-1-.444-1-1zm0 4c0-.552.444-1 1-1 .552 0 1 .444 1 1 0 .552-.444 1-1 1-.552 0-1-.444-1-1z"></path>',"</svg>"].join(""),groupCellDrag:['<svg viewBox="0 0 16 16" style="shape-rendering: geometricprecision;">','<path fill-rule="evenodd" fill="currentColor" d="M5 3.505C5 3.226 5.214 3 5.505 3h.99c.279 0 .505.214.505.505v.99A.497.497 0 0 1 6.495 5h-.99A.497.497 0 0 1 5 4.495v-.99zm4 0C9 3.226 9.214 3 9.505 3h.99c.279 0 .505.214.505.505v.99a.497.497 0 0 1-.505.505h-.99A.497.497 0 0 1 9 4.495v-.99zm-4 4C5 7.226 5.214 7 5.505 7h.99c.279 0 .505.214.505.505v.99A.497.497 0 0 1 6.495 9h-.99A.497.497 0 0 1 5 8.495v-.99zm4 0C9 7.226 9.214 7 9.505 7h.99c.279 0 .505.214.505.505v.99a.497.497 0 0 1-.505.505h-.99A.497.497 0 0 1 9 8.495v-.99zm-4 4c0-.279.214-.505.505-.505h.99c.279 0 .505.214.505.505v.99a.497.497 0 0 1-.505.505h-.99A.497.497 0 0 1 5 12.495v-.99zm4 0c0-.279.214-.505.505-.505h.99c.279 0 .505.214.505.505v.99a.497.497 0 0 1-.505.505h-.99A.497.497 0 0 1 9 12.495v-.99z"></path>',"</svg>"].join(""),remove:['<svg viewBox="0 0 16 16" style="shape-rendering: geometricprecision;">','<path fill-rule="evenodd" fill="currentColor" d="M3.71428571,7 C3.32,7 3,7.224 3,7.5 L3,8.5 C3,8.776 3.32,9 3.71428571,9 L12.2857143,9 C12.68,9 13,8.776 13,8.5 L13,7.5 C13,7.224 12.68,7 12.2857143,7 L3.71428571,7 Z"></path>',"</svg>"].join(""),block:['<svg viewBox="0 0 16 16" style="shape-rendering: geometricprecision;">','<path fill-rule="evenodd" fill="currentColor" d="M3.617 4.677A5.48 5.48 0 0 0 2.5 8 5.5 5.5 0 0 0 8 13.5a5.48 5.48 0 0 0 3.323-1.117zm1.06-1.06 7.706 7.706A5.48 5.48 0 0 0 13.5 8 5.5 5.5 0 0 0 8 2.5a5.48 5.48 0 0 0-3.323 1.117M1 8a7 7 0 1 1 14 0A7 7 0 0 1 1 8 Z"></path>"',"</svg>"].join(""),menu:['<svg viewBox="0 0 28 28">','<path d="M5.5 8a1 1 0 1 1 0-2h17a1 1 0 0 1 0 2h-17Zm0 7a1 1 0 0 1 0-2h17a1 1 0 0 1 0 2h-17Zm0 7a1 1 0 0 1 0-2h17a1 1 0 0 1 0 2h-17Z"></path>',"</svg>"].join(""),sortAsc:['<svg viewBox="0 0 16 16">','<path d="M12.78 6.47a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69a.75.75 0 0 1-1.5 0V4.56L4.28 7.53a.75.75 0 1 1-1.06-1.06l4.25-4.25a.75.75 0 0 1 1.06 0l4.25 4.25Z"></path>',"</svg>"].join(""),sortDesc:['<svg viewBox="0 0 16 16">','<path d="M3.22 9.53a.75.75 0 0 1 1.06-1.06l2.97 2.97V2.75a.75.75 0 0 1 1.5 0v8.69l2.97-2.97a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L3.22 9.53Z"></path>',"</svg>"].join(""),filter:['<svg viewBox="0 0 20 20">','<path d="M7.5 7.75a1 1 0 1 1 0-2 1 1 0 0 1 0 2zM5.11 6A2.5 2.5 0 0 1 9.9 6h6.36a.75.75 0 0 1 0 1.5H9.89a2.5 2.5 0 0 1-4.78 0H3.75a.75.75 0 0 1 0-1.5zm7.39 8.25a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm2.39-1.75a2.5 2.5 0 0 0-4.78 0H3.75a.75.75 0 0 0 0 1.5h6.36a2.5 2.5 0 0 0 4.78 0h1.36a.75.75 0 0 0 0-1.5z"></path>',"</svg>"].join("")},Fancy.cls={HIDDEN:"fg-hidden",GRID:"fg-grid",TOUCH:"fg-touch",HEADER:"fg-header",HEADER_INNER:"fg-header-inner",HEADER_INNER_CONTAINER:"fg-header-inner-container",HEADER_CELL:"fg-header-cell",HEADER_CELL_SORTABLE:"fg-header-cell-sortable",HEADER_CELL_NOT_RESIZABLE:"fg-header-cell-not-resizable",HEADER_CELL_LABEL:"fg-header-cell-label",HEADER_CELL_TEXT:"fg-header-cell-text",HEADER_FILTER_EL:"fg-header-filter-el",HEADER_CELL_RESIZE:"fg-header-cell-resize",HEADER_CELL_MENU:"fg-header-cell-menu",HEADER_CELL_SELECTION:"fg-header-cell-selection",BODY:"fg-body",BODY_INNER:"fg-body-inner",BODY_INNER_CONTAINER:"fg-body-inner-container",COLUMN_RESIZING:"fg-column-resizing",COLUMN_DRAGGING:"fg-column-dragging",FAKE_COLUMN_CELL_DRAGGING:"fg-fake-column-cell-dragging",FAKE_COLUMN_CELL_DRAGGING_ALLOW:"fg-fake-column-cell-dragging-allow",FAKE_COLUMN_CELL_DRAGGING_DENY:"fg-fake-column-cell-dragging-deny",COLUMNS_MENU:"fg-columns-menu",COLUMNS_MENU_ITEM:"fg-columns-menu-item",COLUMNS_MENU_ITEM_TEXT:"fg-columns-menu-item-text",CELL:"fg-cell",ANIMATE_CELLS_POSITION:"fg-animate-cells-position",GRID_CELLS_RIGHT_BORDER:"fg-enabled-cell-right-border",CELL_BOOLEAN:"fg-cell-boolean",CELL_ORDER:"fg-cell-order",CELL_WRAPPER:"fg-cell-wrapper",CELL_SELECTION:"fg-cell-selection",ROW:"fg-row",ROW_ODD:"fg-row-odd",ROW_EVEN:"fg-row-even",ROW_GROUP:"fg-row-group",ROW_SELECTED:"fg-row-selected",ROW_GROUP_VALUE_CELL:"fg-row-group-value-cell",ROW_GROUP_CELL:"fg-row-group-cell",ROW_GROUP_CELL_SELECTION:"fg-row-group-cell-selection",ROW_GROUP_CELL_VALUE:"fg-row-group-cell-value",ROW_GROUP_CELL_AMOUNT:"fg-row-group-cell-amount",ROW_GROUP_CELL_EXPANDER:"fg-row-group-cell-expander",ROW_GROUP_EXPANDED_CELL:"fg-row-group-cell-expanded",ROW_ANIMATION:"fg-row-animation",ROW_HOVER:"fg-row-hover",ROW_GROUP_BAR:"fg-row-group-bar",ROW_GROUP_BAR_EMPTY_TEXT:"fg-row-group-bar-empty-text",ROW_GROUP_BAR_ITEM_CONTAINER:"fg-row-group-bar-item-container",ROW_GROUP_BAR_ITEM:"fg-row-group-bar-item",ROW_GROUP_BAR_ITEM_TEXT:"fg-row-group-bar-item-text",ROW_GROUP_BAR_ITEM_ACTIVE:"fg-row-group-bar-item-active",FILTER_BAR:"fg-filter-bar",FILTER_BAR_CELL:"fg-filter-bar-cell",FILTER_BAR_INNER:"fg-filter-bar-inner",FILTER_BAR_INNER_CONTAINER:"fg-filter-bar-inner-container",FILTER_INDICATOR_CONTAINER:"fg-filter-indicator-container",FILTER_FIELD:"fg-filter-field",FILTER_FIELD_INPUT:"fg-filter-field-input",FILTER_FIELD_TEXT:"fg-filter-field-text",FILTER_FIELD_SIGN:"fg-filter-field-sign",FILTER_FIELD_LIST:"fg-filter-field-list",FILTER_FIELD_LIST_ITEM:"fg-filter-field-list-item",FILTER_FIELD_LIST_ITEM_TEXT:"fg-filter-field-list-item-text",SORT_ORDER:"fg-sort-order",SORT_ASC:"fg-sort-asc",SORT_DESC:"fg-sort-desc",SORT_INDICATOR_CONTAINER:"fg-sort-indicator-container",BODY_VERTICAL_SCROLL:"fg-body-vertical-scroll",BODY_VERTICAL_SCROLL_CONTAINER:"fg-body-vertical-scroll-container",BODY_VERTICAL_SCROLL_SIZE:"fg-body-vertical-scroll-size",BODY_HORIZONTAL_SCROLL:"fg-body-horizontal-scroll",BODY_HORIZONTAL_SCROLL_CONTAINER:"fg-body-horizontal-scroll-container",BODY_HORIZONTAL_SCROLL_SIZE:"fg-body-horizontal-scroll-size",SCROLLBAR_INVISIBLE:"fg-scrollbar-invisible",INPUT_CHECKBOX:"fg-input-checkbox",SVG_ITEM:"fg-svg-item",SVG_CHEVRON_RIGHT:"fg-svg-chevron-right",SVG_GROUP:"fg-svg-group",SVG_DRAG:"fg-svg-drag",SVG_REMOVE:"fg-svg-remove",SVG_BLOCK:"fg-svg-block"},Fancy.render={boolean(e){const{column:t,value:o,cell:r}=e;if(""===o)return;const s=document.createElement("input");s.setAttribute("type","checkbox"),s.checked=o,s.addEventListener("click",(e=>{t.editable||e.preventDefault()})),r.classList.add(Fancy.cls.CELL_BOOLEAN),r.appendChild(s)},order(e){const{item:t,cell:o,rowIndex:r}=e;t.$isGroupRow||(o.classList.add(Fancy.cls.CELL_ORDER),o.innerHTML=r+1)}},Fancy.format={CURRENCY_REGIONS:{USD:"en-US",EUR:"de",GBP:"en-gb",JPY:"jp",CNY:"zh-cn"},currency(e){const t=e.value,o=e.minDecimal||0,r=e.maxDecimal||o||0,s=e.currency||"USD";let l="en-US";return isNaN(t)||""===t||null===t?"":(e.region?l=e.region:Fancy.format.CURRENCY_REGIONS[e.currency]&&(l=Fancy.format.CURRENCY_REGIONS[e.currency]),new Intl.NumberFormat(l,{style:"currency",currency:s,minimumFractionDigits:o,maximumFractionDigits:r}).format(t))}},Fancy.Store=class{data=[];sortedData=void 0;filteredData=void 0;sorters=[];filters=[];rowGroups=[];rowGroupExpanded=[];aggregations=[];idRowIndexesMap=null;idItemMap=null;selectedItemsMap=null;selectedRowGroupsChildren=null;idSeed=0;prevAction="";prevFilterIndex="";constructor({data:e,rowGroups:t,rowGroupExpanded:o,aggregations:r,defaultRowGroupSort:s}){const l=this;l.prevAction="",l.data=e||[],l.rowGroups=t||[],l.rowGroupExpanded=o||[],l.aggregations=r||[],l.defaultRowGroupSort=s||[],l.selectedItemsMap=new Map,l.selectedRowGroupsChildren={},l.data.length&&l.rowGroups.length?(l.lightSetIds(),l.rowGroupData(),l.setIndexAndItemsMaps()):l.setIds()}setData(e){const t=this;t.sortedData=void 0,t.filteredData=void 0,t.data=e,t.rowGroupExpanded,t.selectedItemsMap=new Map,t.selectedRowGroupsChildren={},t.data.length&&t.rowGroups.length?(t.lightSetIds(),t.filters.length&&t.reFilter(),t.rowGroupData(),t.setIndexAndItemsMaps()):(t.setIds(),t.filters.length&&t.reFilter(!1),t.sorters.length&&t.reSort())}lightSetIds(){const e=this;e.idSeed=0,e.data.forEach(((t,o)=>{t.id||(t.id=e.generateId())}))}setIndexAndItemsMaps(){const e=this;e.idItemMap||(e.idItemMap=new Map),e.updateIndexes()}updateIndexes(){const e=this,t=e.displayedData||e.data;e.idRowIndexesMap=new Map,t.forEach(((t,o)=>{e.idRowIndexesMap.set(t.id,o),e.idItemMap.set(t.id,t),t.rowIndex=o,t.originalRowIndex=o}))}setIds(){const e=this;e.idRowIndexesMap=new Map,e.idItemMap=new Map,e.idSeed=0,e.data.forEach(((t,o)=>{t.id||(t.id=e.generateId(),t.originalRowIndex=o),e.idRowIndexesMap.set(t.id,o),e.idItemMap.set(t.id,t)}))}generateId(){return"id-"+this.idSeed++}getDataTotal(){return this.data.length}getDisplayedDataTotal(){const{sorters:e,filters:t,rowGroups:o}=this;return e.length||t.length||o.length?this.displayedData.length:this.getDataTotal()}getItemByRowIndex(e){const t=this,{sorters:o,filters:r,rowGroups:s}=t;let l;return l=o.length||r.length||s.length?t.displayedData[e]:t.data[e],l}memorizePrevRowIndexesMap(){this.prevIdRowIndexesMap=this.idRowIndexesMap}},(()=>{const e={reSort(){const e=this;let t;t=e.filteredData?e.filteredData.slice():e.data.slice(),e.sorters.forEach((o=>{t=e.sortData(t,o.index,o.dir,o.type)})),e.sortedData=t,e.idRowIndexesMap=new Map,e.sortedData.forEach(((t,o)=>{e.idRowIndexesMap.set(t.id,o),t.rowIndex=o})),e.displayedData=e.sortedData},sort(e,t="ASC",o,r){const s=this;let l;switch(l="sort"===s.prevAction&&s.sortedData?s.sortedData.slice():s.filteredData?s.filteredData.slice():s.data.slice(),s.prevIdRowIndexesMap||(s.prevIdRowIndexesMap=s.idRowIndexesMap),s.sorters=r?s.sorters.filter((t=>t.index!==e)):[],s.sorters.push({index:e,dir:t,type:o}),t){case"ASC":case"DESC":s.rowGroups.length?s.sortedData=s.filters.length?s.sortGroupDataForFiltering(e,t,o):s.sortGroupData(e,t,o):s.sortedData=s.sortData(l,e,t,o)}s.idRowIndexesMap=new Map,s.sortedData.forEach(((e,t)=>{s.idRowIndexesMap.set(e.id,t),e.rowIndex=t})),s.displayedData=s.sortedData,s.prevAction="sort"},sortGroupData(e,t,o){const r=this,s=r.displayedData.slice();for(const l in r.expandedGroupsWithDataChildren){if(r.isParentCollapsed(l))continue;const n=r.groupsChildren[l].slice(),i=r.groupDetails[l],a=r.idRowIndexesMap.get(i.id);let d=n;r.sorters.length?r.sorters.forEach((e=>{d=r.sortData(d,e.index,e.dir,e.type)})):d=r.sortData(n,e,t,o),s.splice(a+1,d.length,...d)}return s},sortGroupDataForFiltering(e,t,o){const r=this,s=r.displayedData.slice();for(const l in r.expandedGroupsWithDataChildrenForFiltering){if(r.isParentCollapsed(l))continue;const n=r.groupsChildrenForFiltering[l].slice(),i=r.groupDetailsForFiltering[l],a=r.idRowIndexesMap.get(i.id);let d=n;r.sorters.length?r.sorters.forEach((e=>{d=r.sortData(d,e.index,e.dir,e.type)})):d=r.sortData(n,e,t,o),s.splice(a+1,d.length,...d)}return s},sortPieceOfData(e){const t=this;return t.sorters.forEach((o=>{e=t.sortData(e,o.index,o.dir,o.type)})),e},sortData(e,t,o,r){let s=[];switch(o){case"ASC":switch(r){case"number":s=e.sort(((e,o)=>(e=e[t],o=o[t],null===e&&(e=Number.MIN_SAFE_INTEGER),null===o&&(o=Number.MIN_SAFE_INTEGER),e-o)));break;case"string":s=e.sort(((e,o)=>(e=e[t]||"",o=o[t]||"",e.localeCompare||console.error(`${e} is not a string`),e.localeCompare(o))));break;case"boolean":s=e.sort(((e,o)=>(e=e[t]||!1)===(o=o[t]||!1)?0:e?1:-1))}break;case"DESC":switch(r){case"number":s=e.sort(((e,o)=>(e=e[t],o=o[t],null===e&&(e=Number.MIN_SAFE_INTEGER),null===o&&(o=Number.MIN_SAFE_INTEGER),o-e)));break;case"string":s=e.sort(((e,o)=>(e=e[t]||"",(o=o[t]||"").localeCompare(e))));break;case"boolean":s=e.sort(((e,o)=>(e=e[t]||!1)===(o=o[t]||!1)?0:e?-1:1))}}return s},clearSort(e,t){const o=this;if(o.sortedData=[],o.sorters=e&&t?o.sorters.filter((t=>t.index!==e)):[],o.rowGroups.length||(o.idRowIndexesMap=new Map),o.sorters.length)o.rowGroups.length?(o.sortedData=o.filters.length?o.sortGroupDataForFiltering():o.sortGroupData(),o.idRowIndexesMap=new Map,o.sortedData.forEach(((e,t)=>{o.idRowIndexesMap.set(e.id,t),e.rowIndex=t})),o.displayedData=o.sortedData,o.prevAction="sort"):o.reSort();else if(o.filters.length)o.rowGroups.length?(o.rowGroupDataForFiltering(),o.sortGroupsForFiltering(),o.generateDisplayedGroupedDataForFiltering(!0),o.updateIndexes(),o.prevAction="filter"):(o.filteredData||o.reFilter(!1),o.filteredData.forEach(((e,t)=>{o.idRowIndexesMap.set(e.id,t),e.rowIndex=t})),o.displayedData=o.filteredData);else if(o.rowGroups.length){for(const e in o.expandedGroupsWithDataChildren){o.groupsChildren[e].forEach((e=>{o.idRowIndexesMap.set(e.id,e.originalRowIndex),e.rowIndex=e.originalRowIndex}))}o.sortGroups(),o.simpleReGenerateDisplayedGroupedData()}else o.data.forEach(((e,t)=>{o.idRowIndexesMap.set(e.id,t),e.rowIndex=t}));0===o.sorters.length&&delete o.sortedData},isParentCollapsed(e){const t=this,o=e.split("/");let r=o.length-1;for(let e=0;e<r;e++)if(o.pop(),!t.expandedGroups[o.join("/")])return!0;return!1}};Object.assign(Fancy.Store.prototype,e)})(),(()=>{const e={clearFilter(e,t){const o=this;o.filters=o.filters.filter((t=>t.index!==e)),o.prevFilterIndex="",o.reFilter(!1),o.reSort()},clearFilterForGrouping(e,t){const o=this,r=o.data.slice();o.filters=o.filters.filter((t=>t.index!==e)),o.prevFilterIndex="",o.filteredData=o.filters.reduce(((e,t)=>o.filterData(e,t.index,t.value,t.sign)),r),o.rowGroupDataForFiltering(),o.sortGroupsForFiltering(),o.generateDisplayedGroupedDataForFiltering(),o.updateIndexes(),0===o.filters.length&&delete o.filteredData,o.prevAction="filter"},reFilter(e=!0){const t=this;let o;o=e&&"sort"===t.prevAction&&t.sortedData?t.sortedData.slice():t.data.slice(),t.filteredData=t.filters.reduce(((e,o)=>t.filterData(e,o.index,o.value,o.sign)),o),t.displayedData=t.filteredData,t.updateIndexMapAfterFilter(),0===t.filters.length&&delete t.filteredData,t.prevAction="filter"},filter(e,t,o="="){const r=this;let s,l=!1;if("sort"===r.prevAction&&r.sortedData?s=r.sortedData.slice():"filter"===r.prevAction&&r.prevFilterIndex!==e&&r.filteredData?s=r.filteredData.slice():"filter"===r.prevAction&&r.prevFilterIndex===e?l=!0:s=r.data.slice(),r.filters=r.filters.filter((t=>t.index!==e)),null!==t&&r.filters.push({index:e,value:t,sign:o}),l)return r.reFilter(),void r.reSort();r.filteredData=r.filterData(s,e,t,o),r.displayedData=r.filteredData,r.updateIndexMapAfterFilter(),r.prevAction="filter",r.prevFilterIndex=e},filterForRowGrouping(e,t,o="="){const r=this,s=r.data.slice();r.filters=r.filters.filter((t=>t.index!==e)),null!==t&&r.filters.push({index:e,value:t,sign:o}),r.filteredData=r.filters.reduce(((e,t)=>r.filterData(e,t.index,t.value,t.sign)),s),r.rowGroupDataForFiltering(),r.sortGroupsForFiltering(),r.generateDisplayedGroupedDataForFiltering(),r.updateIndexes(),r.prevAction="filter",r.prevFilterIndex=e},updateIndexMapAfterFilter(){const e=this;e.memorizePrevRowIndexesMap(),e.idRowIndexesMap=new Map,e.filteredData.forEach(((t,o)=>{e.idRowIndexesMap.set(t.id,o),t.rowIndex=o}))},filterData(e,t,o,r){let s=[];switch(o=String(o).toLocaleLowerCase(),r){case"=":s=e.filter((e=>String(e[t]).toLocaleLowerCase().includes(o)));break;case"!=":s=e.filter((e=>!String(e[t]).toLocaleLowerCase().includes(o)));break;case"==":s=e.filter((e=>String(e[t]).toLocaleLowerCase()===o));break;case"!==":s=e.filter((e=>String(e[t]).toLocaleLowerCase()!==o));break;case">":s=e.filter((e=>e[t]>o));break;case"<":s=e.filter((e=>e[t]<o));break;case"_a":s=e.filter((e=>String(e[t]).toLocaleLowerCase().startsWith(o)));break;case"a_":s=e.filter((e=>String(e[t]).toLocaleLowerCase().endsWith(o)));break;case"regex":s=e.filter((e=>{const r=String(e[t]).toLocaleLowerCase();return new RegExp(o).test(r)}));break;case"empty":s=e.filter((e=>{switch(e[t]){case void 0:case null:case"":return!0}return!1}));break;case"!empty":s=e.filter((e=>{switch(e[t]){case void 0:case null:case"":return!1}return!0}));break;case"+":s=e.filter((e=>e[t]>=0));break;case"-":s=e.filter((e=>e[t]<0))}return s}};Object.assign(Fancy.Store.prototype,e)})(),(()=>{const e={rowGroupData(){const e=this;e.set$rowGroupValue(),e.setExpandedGroups(),e.generateGroupsInfo(),e.sortGroups(),e.generateDisplayedGroupedData()},rowGroupDataForFiltering(){this.generateGroupsInfoForFiltering()},generateDisplayedGroupedData(){const e=this,t=e.getSortedDisplayedGroups();let o=[];t.forEach((t=>{const r=e.groupsChildren[t],s=e.groupDetails[t],l=e.expandedGroups[t]||!1;o.push(s),!s.$hasChildrenGroups&&l&&(o=o.concat(r))})),e.displayedData=o},simpleReGenerateDisplayedGroupedData(e,t,o){const r=this,s=r.displayedData.slice();for(const e in r.expandedGroupsWithDataChildren){if(r.isParentCollapsed(e))continue;const t=r.groupsChildren[e].slice(),o=r.groupDetails[e],l=r.idRowIndexesMap.get(o.id);s.splice(l+1,t.length,...t)}r.displayedData=s},generateDisplayedGroupedDataForFiltering(e=!1){const t=this;let o=[],r=[];e?r=t.getGroupDataForFiltering():(o=t.getSortedDisplayedGroupsForFiltering(),o.forEach((e=>{const o=t.groupsChildrenForFiltering[e],s=t.groupDetailsForFiltering[e],l=t.expandedGroups[e]||!1;r.push(s),!s.$hasChildrenGroups&&l&&(r=r.concat(o))}))),t.displayedData=r},generateGroupsInfo(e,t){const o=this,r={};let s=!0;if(void 0===e&&(o.groupsChildren=o.groupsChildren||Object.groupBy(o.data,(e=>e.$rowGroupValue)),e=Object.keys(o.groupsChildren),t=o.rowGroups.length-1,s=!1,o.groupDetails={},o.levelsWithGroups=[],o.expandedGroupsWithDataChildren={}),e.forEach((e=>{const l=e.split("/"),n=l.pop();let i="root";0!==t&&(i=l.join("/"),r[i]=!0);const a=l.join("/"),d=o.expandedGroups[e]||!1;o.groupsChildren[a]=o.groupsChildren[a]||[],o.levelsWithGroups[t]=o.levelsWithGroups[t]||[{}],o.levelsWithGroups[t][0][i]=o.levelsWithGroups[t][0][i]||[],o.levelsWithGroups[t][0][i].push(e);const c={$rowGroupValue:e,$rowDisplayGroupValue:n,$groupLevel:t,$isGroupRow:!0,$hasChildrenGroups:s,id:o.generateId(),childrenAmount:o.groupsChildren[e].length,expanded:d,$agValues:{}};s?(o.aggregations.forEach((t=>{const r=o.groupsChildren[e].map((e=>e.$agValues[t.index]));c.$agValues[t.index]=o.getAggregationResult(t,r)})),c.amount=o.groupsChildren[e].reduce(((e,t)=>e+t.amount),0)):(o.aggregations.forEach((t=>{const r=o.groupsChildren[e].map((e=>e[t.index]));c.$agValues[t.index]=o.getAggregationResult(t,r)})),c.amount=c.childrenAmount,c.expanded&&(o.expandedGroupsWithDataChildren[e]=!0)),o.groupDetails[e]=c,0!==t&&o.groupsChildren[a].push(c)})),0!==t){const e=Object.keys(r);o.generateGroupsInfo(e,t-1)}},generateGroupsInfoForFiltering(e,t){const o=this,r={};let s=!0;if(void 0===e&&(o.groupsChildrenForFiltering=Object.groupBy(o.filteredData,(e=>e.$rowGroupValue)),e=Object.keys(o.groupsChildrenForFiltering),t=o.rowGroups.length-1,s=!1,o.groupDetailsForFiltering={},o.levelsWithGroupsForFiltering=[],o.expandedGroupsWithDataChildrenForFiltering={}),e.forEach((e=>{const l=o.groupDetails[e],n=e.split("/"),i=n.pop();let a="root";0!==t&&(a=n.join("/"),r[a]=!0);const d=n.join("/"),c=o.expandedGroups[e]||!1;o.groupsChildrenForFiltering[d]=o.groupsChildrenForFiltering[d]||[],o.levelsWithGroupsForFiltering[t]=o.levelsWithGroupsForFiltering[t]||[{}],o.levelsWithGroupsForFiltering[t][0][a]=o.levelsWithGroupsForFiltering[t][0][a]||[],o.levelsWithGroupsForFiltering[t][0][a].push(e),l||console.error(`groupDetails does not contain ${e}`);const u={$rowGroupValue:e,$rowDisplayGroupValue:i,$groupLevel:t,$isGroupRow:!0,$hasChildrenGroups:s,id:l.id,childrenAmount:o.groupsChildrenForFiltering[e].length,expanded:c,$agValues:{}};s?(o.aggregations.forEach((t=>{const r=o.groupsChildrenForFiltering[e].map((e=>e.$agValues[t.index]));u.$agValues[t.index]=o.getAggregationResult(t,r)})),u.amount=o.groupsChildrenForFiltering[e].reduce(((e,t)=>e+t.amount),0)):(o.aggregations.forEach((t=>{const r=o.groupsChildrenForFiltering[e].map((e=>e[t.index]));u.$agValues[t.index]=o.getAggregationResult(t,r)})),u.amount=u.childrenAmount,u.expanded&&(o.expandedGroupsWithDataChildrenForFiltering[e]=!0)),o.groupDetailsForFiltering[e]=u,0!==t&&o.groupsChildrenForFiltering[d].push(u)})),0===t)o.generateDisplayedGroupsForFiltering(e);else{const e=Object.keys(r);o.generateGroupsInfoForFiltering(e,t-1)}},clearGroups(){const e=this;delete e.groupsChildren,delete e.levelsWithGroups,delete e.expandedGroupsWithDataChildren,e.data.forEach((e=>{delete e.$rowGroupValue}))},set$rowGroupValue(){this.data.forEach((e=>{let t=[];this.rowGroups.forEach((o=>{t.push(e[o])})),e.$rowGroupValue=t.join("/")}))},setExpandedGroups(){const e=this;if(e.expandedGroups={},"function"==typeof e.rowGroupExpanded){const t=Object.keys(Object.groupBy(e.data,(e=>e.$rowGroupValue))),o={};t.forEach((e=>{const t=e.split("/"),r=t.length;for(let e=0;e<r;e++)t.pop(),o[t.join("/")]=!0}));const r=Object.keys(o),s=[].concat(t).concat(r).sort();s.forEach((t=>{const o=e.rowGroupExpanded(t);e.expandedGroups[t]=o,o&&s.push(t)})),e.rowGroupExpanded=s}else e.rowGroupExpanded.forEach((t=>{e.expandedGroups[t]=!0}))},generateDisplayedGroupsForFiltering(e){const t=this;t.displayedGroupsForFiltering={},e.forEach((e=>{t.displayedGroupsForFiltering[e]=!0})),t.rowGroupExpanded.forEach((e=>{const o=t.groupsChildrenForFiltering[e];o?.forEach((({$rowGroupValue:e})=>{e&&(t.displayedGroupsForFiltering[e]=!0)}))}))},sortGroups(){const e=this;e.levelsWithGroups.forEach((({0:t})=>{for(const o in t){const r=t[o].toSorted(((t,o)=>{const r=e.groupDetails[t],s=e.groupDetails[o];switch(e.defaultRowGroupSort){case"asc-amount":return r.amount-s.amount;case"desc-amount":return s.amount-r.amount}}));t[o]=r}}))},sortGroupsForFiltering(){const e=this,t=[];e.levelsWithGroups.forEach((({0:o},r)=>{const s={};for(const t in o){const l=o[t].filter((t=>e.displayedGroupsForFiltering[t]));(e.displayedGroupsForFiltering[t]||0===r)&&(s[t]=l)}t[r]=[s]})),e.levelsWithGroupsForFiltering=t},getSortedDisplayedGroups(){const e=this;let t=[];const o=(r,s=0)=>{r.forEach((r=>{if(t.push(r),e.expandedGroups[r]&&s!==e.levelsWithGroups.length-1){const t=s+1,l=e.levelsWithGroups[t][0][r];o(l,t)}}))};switch(e.defaultRowGroupSort){case"desc-string":t=Array.from(Object.keys(e.displayedGroups)).sort();break;case"desc-amount":const r=e.levelsWithGroups[0][0].root;o(r);break;default:console.error(`Not supported defaultRowGroupSort value ${e.defaultRowGroupSort}`)}return t},getSortedDisplayedGroupsForFiltering(){const e=this;let t=[];const o=(r,s=0)=>{r.forEach((r=>{if(t.push(r),e.expandedGroups[r]&&s!==e.levelsWithGroupsForFiltering.length-1){const t=s+1,l=e.levelsWithGroupsForFiltering[t][0][r];o(l,t)}}))};switch(e.defaultRowGroupSort){case"desc-string":t=Array.from(Object.keys(e.displayedGroupsForFiltering)).sort();break;case"desc-amount":const r=e.levelsWithGroupsForFiltering[0][0].root;o(r);break;default:console.error(`Not supported defaultRowGroupSort value ${e.defaultRowGroupSort}`)}return t},getAggregationResult(e,t){let o="";if("function"==typeof e.fn)o=e.fn(t);else switch(e.fn){case"sum":o=t.reduce(((e,t)=>e+t),0);break;case"avg":const e=t.reduce(((e,t)=>e+t),0);o=parseFloat((e/t.length).toFixed(2));break;case"min":o=t.sort()[0];break;case"max":o=t.sort()[t.length-1]}return o},expand(e){const t=this,o=t.groupDetails[e],r=t.idRowIndexesMap.get(o.id);o.expanded=!0,t.expandedGroups[e]=!0,o.$hasChildrenGroups||(t.expandedGroupsWithDataChildren[e]=!0);const s=t.getGroupExpandedChildren(e);t.displayedData.splice(r+1,0,...s),t.rowGroupExpanded.push(e),t.updateIndexes()},expandForFiltering(e){const t=this,o=t.groupDetailsForFiltering[e],r=t.idRowIndexesMap.get(o.id);o.expanded=!0,t.expandedGroups[e]=!0,o.$hasChildrenGroups||(t.expandedGroupsWithDataChildren[e]=!0,t.expandedGroupsWithDataChildrenForFiltering[e]=!0);const s=t.getGroupExpandedChildrenForFiltering(e);t.displayedData.splice(r+1,0,...s),t.rowGroupExpanded.push(e),t.updateIndexes()},expandAll(){const e=this;e.prevAction="",e.rowGroupExpanded=()=>!0,e.rowGroupExpanded=[];for(const t in e.groupDetails){const o=e.groupDetails[t];e.expandedGroups[t]=!0,e.rowGroupExpanded.push(t),o.expanded=!0,o.$hasChildrenGroups||(e.expandedGroupsWithDataChildren[t]=!0)}e.generateDisplayedGroupedData(),e.setIndexAndItemsMaps()},toggleExpand(e){const t=this;t.groupDetails[e].expanded?t.collapse(e):t.expand(e)},collapse(e){const t=this,o=t.getGroupExpandedChildren(e),r=t.groupDetails[e],s=t.idRowIndexesMap.get(r.id);r.expanded=!1,delete t.expandedGroups[e],r.$hasChildrenGroups||delete t.expandedGroupsWithDataChildren[e],t.displayedData.splice(s+1,o.length),t.rowGroupExpanded=t.rowGroupExpanded.filter((t=>t!==e)),t.updateIndexes()},collapseForFiltering(e){const t=this,o=t.groupDetailsForFiltering[e],r=t.getGroupExpandedChildrenForFiltering(e),s=t.idRowIndexesMap.get(o.id);o.expanded=!1,delete t.expandedGroups[e],o.$hasChildrenGroups||(delete t.expandedGroupsWithDataChildren[e],delete t.expandedGroupsWithDataChildrenForFiltering[e]),t.displayedData.splice(s+1,r.length),t.rowGroupExpanded=t.rowGroupExpanded.filter((t=>t!==e)),t.updateIndexes()},collapseAll(){const e=this;e.prevAction="",e.rowGroupExpanded=()=>!1,e.rowGroupExpanded=[];for(const t in e.groupDetails)e.expandedGroups[t]=!1,e.groupDetails[t].expanded=!1;e.generateDisplayedGroupedData(),e.setIndexAndItemsMaps()},getGroupExpandedChildren(e,t=[]){const o=this,r=o.groupDetails[e];let s=o.groupsChildren[e].slice();return!r.$hasChildrenGroups&&o.sorters.length?s=o.sortPieceOfData(s):s.sort(((e,t)=>{switch(o.defaultRowGroupSort){case"asc-amount":return e.amount-t.amount;case"desc-amount":return t.amount-e.amount}})),s.forEach((e=>{if(t.push(e),e.$isGroupRow&&e.expanded){const r=e.$rowGroupValue;o.getGroupExpandedChildren(r,t)}})),t},getGroupExpandedChildrenForFiltering(e,t=[]){const o=this,r=o.groupDetailsForFiltering[e];let s=o.groupsChildrenForFiltering[e].slice();return!r.$hasChildrenGroups&&o.sorters.length&&(s=o.sortPieceOfData(s)),s.forEach((e=>{if(t.push(e),e.$isGroupRow&&e.expanded){const r=e.$rowGroupValue;o.getGroupExpandedChildrenForFiltering(r,t)}})),t},reConfigRowGroups(e){const t=this,{sorters:o,filters:r}=t;t.setRowGroups(e),t.prevAction="",t.rowGroupExpanded=[],t.expandedGroups={},delete t.groupsChildren,0===e.length?(t.clearGroups(),o.length||r.length?(r.length&&t.reFilter(!1),o.length&&t.reSort()):delete t.displayedData):r.length?(t.set$rowGroupValue(),t.generateGroupsInfo(),t.sortGroups(),t.rowGroupDataForFiltering(),t.sortGroupsForFiltering(),t.generateDisplayedGroupedDataForFiltering(),t.updateIndexes()):(t.set$rowGroupValue(),t.generateGroupsInfo(),t.sortGroups(),t.generateDisplayedGroupedData()),r.length&&e.length||t.setIndexAndItemsMaps()},setRowGroups(e){this.rowGroups=e},getGroupDataForFiltering(){const e=this,t=e.displayedData.slice();for(const o in e.expandedGroupsWithDataChildrenForFiltering){if(e.isParentCollapsed(o))continue;const r=e.groupsChildrenForFiltering[o].slice(),s=e.groupDetailsForFiltering[o],l=e.idRowIndexesMap.get(s.id);t.splice(l+1,r.length,...r)}return t}};Object.assign(Fancy.Store.prototype,e)})(),(()=>{const e={selectRowItem(e,t=!0){const o=this,r=e.$rowGroupValue;if(e.$selected=t,o.updateSelectedItemsMap(t,e),r){o.updateSelectedRowGroupsChildren(r,t,e),o.updateSelectedStatus(r);const s=r.split("/"),l=s.length;for(let e=0;e<l-1;e++){const e=s.join("/"),r=o.groupDetails[e],l=o.idItemMap.get(r.id);s.pop();const n=s.join("/");o.updateSelectedRowGroupsChildren(n,t,l),o.updateSelectedStatus(n)}}},updateGroupsChildrenSelection(e,t){const o=this;o.groupsChildren[e].forEach((r=>{r.$selected=t,r.$isGroupRow||o.updateSelectedItemsMap(t,r),o.updateSelectedRowGroupsChildren(e,t,r);const s=r.$rowGroupValue;r.$isGroupRow&&(r.selectedStatus=!!t&&"full",o.updateGroupsChildrenSelection(s,t))}))},selectGroupRowItems(e,t=!0){const o=this,r=e.$rowGroupValue;e.$selected=t,e.selectedStatus=!!t&&"full",e.$isGroupRow||o.updateSelectedItemsMap(t,e),o.updateGroupsChildrenSelection(r,t),o.updateSelectedStatus(r);const s=r.split("/"),l=s.length;for(let e=0;e<l-1;e++){const e=s.join("/"),r=o.groupDetails[e],l=o.idItemMap.get(r.id);s.pop();const n=s.join("/");o.updateSelectedRowGroupsChildren(n,t,l),o.updateSelectedStatus(n)}},updateSelectedItemsMap(e,t){const o=this;t.$isGroupRow&&console.warn("It is wrong to use selectedItemsMap for group row. Only for items that do not have children."),e?o.selectedItemsMap.set(t.id,t):o.selectedItemsMap.delete(t.id)},updateSelectedRowGroupsChildren(e,t,o){const r=this.selectedRowGroupsChildren;t?(void 0===r[e]&&(r[e]=new Set),r[e].add(o.id)):r[e]&&(r[e].delete(o.id),0===r[e].size&&delete r[e])},updateSelectedStatus(e){const t=this,o=t.groupDetails[e],r=t.idItemMap.get(o.id);let s;t.selectedRowGroupsChildren[e]?t.groupsChildren[e].length===t.selectedRowGroupsChildren[e].size?(s="full",r.$selected=!0):(s="partly",delete r.$selected):(s=!1,r.$selected=!1,t.selectedItemsMap.delete(o.id)),t.groupDetails[e].selectedStatus=s},selectAll(e=!0){const t=this;if(e){for(const e in t.groupsChildren){const o=t.groupsChildren[e],r=t.groupDetails[e];r&&(r.selectedStatus="full",r.$selected=!0,o.forEach((o=>{t.updateSelectedRowGroupsChildren(e,!0,o)})))}t.data.forEach((e=>{e.$selected=!0,t.selectedItemsMap.set(e.id,e)}))}else{for(const e in t.groupsChildren){const o=t.groupsChildren[e],r=t.groupDetails[e];r&&(r.selectedStatus=!1,delete r.$selected,o.forEach((o=>{t.updateSelectedRowGroupsChildren(e,!1,o)})))}t.data.forEach((e=>{delete e.$selected,t.selectedItemsMap.delete(e.id)}))}}};Object.assign(Fancy.Store.prototype,e)})(),(()=>{const{BODY_VERTICAL_SCROLL:e,BODY_VERTICAL_SCROLL_CONTAINER:t,BODY_VERTICAL_SCROLL_SIZE:o,BODY_HORIZONTAL_SCROLL:r,BODY_HORIZONTAL_SCROLL_CONTAINER:s,BODY_HORIZONTAL_SCROLL_SIZE:l,SCROLLBAR_INVISIBLE:n}=Fancy.cls;Fancy.Scroller=class{startRow=0;endRow=0;scrollTop=0;scrollLeft=0;maxScrollTop=0;deltaRowHeight=50;topBufferRows=10;bufferRows=30;extraBufferRows=20;columnViewStart=0;columnViewEnd=0;columnsViewRange=[];scrollBarWidth=17;isDomInvisibleScrollbar=!1;constructor(e){const t=this;t.grid=e.grid,t.calcScrollBarWidth(),t.calcViewRange(),t.initResizeObserver()}deltaChange(e){const t=this;if(!t.isVerticalVisible())return t.scrollTop=0,t.verticalScrollContainerEl.scrollTop=0,!1;let o=!1,r=t.scrollTop-e;return r<0&&(r=0),r>t.maxScrollTop&&(r=t.maxScrollTop),t.scrollTop!==r&&(o=!0),t.scrollTop=r,t.verticalScrollContainerEl.scrollTop=r,o}horizontalDeltaChange(e){const t=this;if(!t.isHorizontalVisible())return t.scrollLeft=0,t.horizontalScrollContainerEl.scrollLeft=0,!1;let o=!1,r=t.scrollLeft-e;return r<0&&(r=0),t.horizontalScrollContainerEl.scrollLeft!==r&&(o=!0),t.horizontalScrollContainerEl.scrollLeft=r,t.scrollLeft=t.horizontalScrollContainerEl.scrollLeft,o}calcVisibleRows(){const e=this;let t=!1;const o=Math.ceil(e.grid.height/e.grid.rowHeight)+e.extraBufferRows;return e.bufferRows<o&&(t=!0),e.bufferRows=o,t}calcMaxScrollTop(){const e=this;e.maxScrollTop=e.grid.store.getDisplayedDataTotal()*e.grid.rowHeight-e.grid.bodyEl.getBoundingClientRect().height,e.maxScrollTop<0&&(e.maxScrollTop=0)}updateScrollTop(){const e=this;e.scrollTop>e.maxScrollTop&&(e.scrollTop=e.maxScrollTop,e.verticalScrollContainerEl.scrollTop=e.maxScrollTop)}getStartRow(){return this.calcStartRow(),this.startRow}calcStartRow(){const e=this;let t=Math.round(e.scrollTop/e.grid.rowHeight)-e.topBufferRows;const o=e.getEndRow();o-t<e.bufferRows&&(t=o-e.bufferRows),t<0&&(t=0),e.startRow=t}getEndRow(){const e=this,t=e.grid.store,{rowGroups:o}=t,r=t.getDisplayedDataTotal();let s=Math.round(e.scrollTop/e.grid.rowHeight)-e.topBufferRows+e.bufferRows;return!o.length&&s>e.grid.store.getDataTotal()&&(s=e.grid.store.getDataTotal()),s>r&&(s=r),e.endRow=s,s}render(){const e=this;e.renderVerticalScroll(),e.renderHorizontalScroll(),e.ons()}renderVerticalScroll(){const r=this,s=document.createElement("div");s.classList.add(e),r.isDomInvisibleScrollbar&&s.classList.add(n);const l=document.createElement("div");l.classList.add(t),l.style.width=r.scrollBarWidth+"px";const i=document.createElement("div");i.classList.add(o),i.style.width=r.scrollBarWidth+"px",l.appendChild(i),s.appendChild(l),r.grid.bodyEl.appendChild(s),r.verticalScrollEl=s,r.verticalScrollContainerEl=l,r.verticalScrollSizeEl=i,r.setVerticalSize()}renderHorizontalScroll(){const e=this,t=document.createElement("div");t.classList.add(r),e.isDomInvisibleScrollbar&&t.classList.add(n),t.style.height=e.scrollBarWidth+"px",t.style.minHeight=e.scrollBarWidth+"px",t.style.maxHeight=e.scrollBarWidth+"px",e.isDomInvisibleScrollbar||!e.isVerticalVisible()?t.style.width="100%":t.style.width=`calc(100% - ${e.scrollBarWidth}px)`;const o=document.createElement("div");o.classList.add(s),o.style.height=e.scrollBarWidth+"px",o.style.minHeight=e.scrollBarWidth+"px",o.style.maxHeight=e.scrollBarWidth+"px";const i=document.createElement("div");i.classList.add(l),i.style.height=e.scrollBarWidth+"px",i.style.minHeight=e.scrollBarWidth+"px",i.style.maxHeight=e.scrollBarWidth+"px",o.appendChild(i),t.appendChild(o),e.grid.gridEl.appendChild(t),e.horizontalScrollEl=t,e.horizontalScrollContainerEl=o,e.horizontalScrollSizeEl=i,e.setHorizontalSize()}updateHorizontalScrollSize(){const e=this,t=e.horizontalScrollEl;e.isDomInvisibleScrollbar?t.style.width="100%":e.isVerticalVisible()?t.style.width=`calc(100% - ${e.scrollBarWidth}px)`:t.style.width="100%"}ons(){const e=this;e.verticalScrollContainerEl.addEventListener("scroll",e.onVerticalScroll),e.horizontalScrollContainerEl.addEventListener("scroll",e.onHorizontalScroll)}onVerticalScroll=()=>{const e=this;e.grid.wheelScrolling||(e.scrollTop=e.verticalScrollContainerEl.scrollTop,e.grid.bodyInnerEl.scrollTop=e.scrollTop,cancelAnimationFrame(e.grid.animationRenderId),e.grid.animationRenderId=requestAnimationFrame((()=>{e.grid.renderVisibleRows()})),cancelAnimationFrame(e.grid.animationRemoveId),e.grid.animationRemoveId=requestAnimationFrame((()=>{e.grid.removeNotNeededRows()})))};onHorizontalScroll=()=>{const e=this;e.scrollLeft=e.horizontalScrollContainerEl.scrollLeft,e.grid.headerEl.scrollLeft=e.scrollLeft,e.grid.bodyInnerEl.scrollLeft=e.scrollLeft,e.grid.filterBar&&(e.grid.filterBarEl.scrollLeft=e.scrollLeft),cancelAnimationFrame(e.grid.horizontalScrollId),e.grid.horizontalScrollId=requestAnimationFrame((()=>{e.generateNewRange()}))};generateNewRange(e=!0){const t=this,{columnStart:o,columnEnd:r,range:s}=t.getColumnsViewRange(),l=new Set(s),n=new Set(t.columnsViewRange),i=[],a=[];return e&&(s.forEach((e=>{t.grid.columns[e].hidden||n.has(e)||i.push(e)})),n.forEach((e=>{l.has(e)||a.push(e)}))),t.columnsViewRange=s,t.columnViewStart=o,t.columnViewEnd=r,t.grid.addColumnCells(i),t.grid.removeColumnCells(a),{columnsViewRange:t.columnsViewRange,columnViewStart:t.columnViewStart,columnViewEnd:t.columnViewEnd,columnsToAdd:i,columnsToRemove:a}}setVerticalSize(){const e=this,t=e.grid,o=t.store,{filters:r,rowGroups:s}=o;let l;l=r.length||s.length?o.getDisplayedDataTotal()*t.rowHeight:o.getDataTotal()*t.rowHeight,e.verticalScrollSizeEl.style.height=l+"px",e.isVerticalVisible()?e.verticalScrollEl.style.display="":e.verticalScrollEl.style.display="none"}isHorizontalVisible(){const e=this.grid.bodyEl.getBoundingClientRect().width;return this.grid.columns.reduce(((e,t)=>t.hidden?e:e+t.width),0)>e}isVerticalVisible(){const e=this.grid,t=e.store,{filters:o,rowGroups:r}=t,s=e.bodyEl.getBoundingClientRect().height,l=e.rowHeight;let n;return n=o.length||r.length?t.getDisplayedDataTotal()*l:t.getDataTotal()*l,s<n}setHorizontalSize(){const e=this,t=e.grid.getTotalColumnsWidth();e.horizontalScrollSizeEl.style.width=`${t}px`,e.isHorizontalVisible()?e.horizontalScrollEl.style.display="":e.horizontalScrollEl.style.display="none"}calcViewRange(){const e=this,{columnStart:t,columnEnd:o,range:r}=e.getColumnsViewRange();e.columnViewStart=t,e.columnViewEnd=o,e.columnsViewRange=r}getColumnsViewRange(){const e=this,t=e.grid.width;let o,r,s=[],l=0;for(let n=0;n<e.grid.columns.length;n++){const i=e.grid.columns[n];if(!i.hidden){if(void 0===o&&l<=e.scrollLeft&&l+i.width>e.scrollLeft&&(o=n),void 0!==o&&s.push(n),void 0===r&&l<=e.scrollLeft+t&&l+i.width>=e.scrollLeft+t){e.grid.columns[n+1]?(r=n+1,s.push(n+1)):r=n;break}l+=i.width}}return void 0===r&&(r=e.grid.columns.length-1),{columnStart:o,columnEnd:r,range:s}}calcScrollBarWidth(){this.scrollBarWidth=this.getScrollbarWidth()}getScrollbarWidth(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let o=t.offsetWidth-t.clientWidth;return t.parentNode&&t.parentNode.removeChild(t),0===o&&(this.isDomInvisibleScrollbar=0===o,o=16),o}initResizeObserver(){const e=this,t=e.grid;e.resizeObserver=new ResizeObserver((o=>{if(Array.isArray(o)&&o.length&&e.grid.checkSize()){const o=e.calcVisibleRows();e.generateNewRange(),t.reCalcColumnsPositions(),t.updateWidth(),t.updateCellPositions(),o&&t.renderVisibleRows()}})),e.resizeObserver.observe(e.grid.containerEl)}isColumnVisible(e){const t=this;if(!e)return!1;for(let o=0,r=t.columnsViewRange.length;o<r;o++){const r=t.columnsViewRange[o];if(t.grid.columns[r].id===e.id)return!0}return!1}}})(),Fancy.TouchScroller=class{constructor(e,t){const o=this;Object.assign(o,t),o.element=e,o.startY=0,o.startX=0,o.velocityX=0,o.velocityY=0,o.lastMoveTime=0,o.touchStartHandler=o.touchStart.bind(o),o.touchMoveHandler=o.touchMove.bind(o),o.touchEndHandler=o.touchEnd.bind(o),o.init()}init(){const e=this;e.element.addEventListener("touchstart",e.touchStartHandler),e.element.addEventListener("touchmove",e.touchMoveHandler),e.element.addEventListener("touchend",e.touchEndHandler)}touchStart(e){const t=this;delete t.direction,t.startY=e.touches[0].pageY,t.startX=e.touches[0].pageX,t.velocityX=0,t.velocityY=0,t.lastMoveTime=Date.now(),t.intervalId&&(clearInterval(t.intervalId),delete t.intervalId)}touchMove(e){const t=this,o=e.touches[0].pageY,r=e.touches[0].pageX,s=Date.now(),l=o-t.startY,n=r-t.startX,i=s-t.lastMoveTime;t.velocityX=n/i,t.velocityY=l/i,t.startY=o,t.startX=r,t.lastMoveTime=s,t.direction||(Math.abs(l)>Math.abs(n)?t.direction="vertical":t.direction="horizontal"),"vertical"===t.direction?Object.assign(e,{deltaX:0,deltaY:l}):Object.assign(e,{deltaX:n,deltaY:0}),t.onTouchScroll(e)}smoothScroll(){const e=this,t=()=>{e.velocityX*=.98,e.velocityY*=.98,"vertical"===e.direction?e.onTouchScroll({deltaX:0,deltaY:10*e.velocityY}):e.onTouchScroll({deltaX:10*e.velocityX,deltaY:0}),Math.abs(e.velocityX)<=.2&&Math.abs(e.velocityY)<=.2||requestAnimationFrame((()=>{requestAnimationFrame(t)}))};requestAnimationFrame(t)}touchEnd(){this.smoothScroll()}destroy(){const e=this;e.element.removeEventListener("touchstart",e.touchStartHandler),e.element.removeEventListener("touchmove",e.touchMoveHandler),e.element.removeEventListener("touchend",e.touchEndHandler),e.intervalId&&clearInterval(e.intervalId)}},(()=>{const{GRID:e,GRID_CELLS_RIGHT_BORDER:t,ROW_ANIMATION:o,HEADER:r,HEADER_INNER:s,HEADER_INNER_CONTAINER:l,BODY:n,BODY_INNER:i,BODY_INNER_CONTAINER:a,TOUCH:d}=Fancy.cls;class c{theme="default";defaultColumnWidth=120;headerRowHeight=32;rowHeight=28;rowAnimation=!0;minColumnWidth=35;rowGroupType="row";defaultRowGroupSort="desc-amount";rowGroupBarSeparator=!1;actualRowsIdSet;renderedRowsIdMap;$defaultRowGroupColumn={title:"Group",width:120,sortable:!1,type:"string",rowGroupIndent:!0,render(e){const{value:t}=e;return t||""}};constructor(e,t){const o=this;t&&(t.renderTo=e,e=t),o.initContainer(e.renderTo),o.initId(e.id),o.actualRowsIdSet=new Set,o.renderedRowsIdMap=new Map,e=o.prepareConfig(e),Object.assign(o,e),o.checkSize(),o.initScroller(),o.render(),o.scroller.calcMaxScrollTop(),o.scroller.calcVisibleRows(),o.renderVisibleRows(),o.renderVisibleHeaderCells(),o.filterBar&&o.renderVisibleFilterBarCells(),o.ons()}initContainer(e){const t=this;e.tagName?t.containerEl=e:"string"==typeof e&&(t.containerEl=document.getElementById(e),t.containerEl||(t.containerEl=document.querySelector(e))),t.containerEl||console.error("Could not find renderTo element")}initId(e){const t=this;e&&(t.id=e),t.id||(t.id=`fg-grid-${Fancy.gridIdSeed}`,Fancy.gridIdSeed++),Fancy.gridsMap.set(t.id,t)}render(){const r=this,s=document.createElement("div");s.setAttribute("id",r.id),s.classList.add(e),r.rowAnimation&&s.classList.add(o),(r.cellsRightBorder||r.columnLines)&&s.classList.add(t),Fancy.isTouchDevice&&s.classList.add(d),s.classList.add("fg-theme-"+r.theme),r.containerEl.appendChild(s),r.gridEl=s,r.rowGroupBar&&r.renderRowGroupBar(),r.renderHeader(),r.filterBar&&r.renderFilterBar(),r.renderBody(),r.scroller.render()}updateWidth(){const e=this,t=e.getTotalColumnsWidth(),o=t+e.scroller.scrollBarWidth,r=t;e.headerInnerEl.style.width=o+"px",e.headerInnerContainerEl.style.width=t+"px",e.bodyInnerContainerEl.style.width=r+"px",e.filterBar&&(e.filterBarInnerEl.style.width=o+"px",e.filterBarInnerContainerEl.style.width=t+"px"),e.scroller.setHorizontalSize()}renderHeader(){const e=this,t=document.createElement("div");t.classList.add(r),t.style.height=this.headerRowHeight+1+"px";const o=document.createElement("div");o.classList.add(s),o.style.width=e.getTotalColumnsWidth()+e.scroller.scrollBarWidth+"px";const n=document.createElement("div");n.classList.add(l),n.style.height=e.headerRowHeight+"px",n.style.width=e.getTotalColumnsWidth()+"px",o.appendChild(n),t.appendChild(o),e.gridEl.appendChild(t),e.headerInnerContainerEl=n,e.headerInnerEl=o,e.headerEl=t}renderBody(){const e=this,t=document.createElement("div");t.classList.add(n);const o=document.createElement("div");o.classList.add(i);const r=document.createElement("div");r.classList.add(a),e.store.rowGroups.length?r.style.height=e.store.getDisplayedDataTotal()*e.rowHeight+"px":r.style.height=e.store.getDataTotal()*e.rowHeight+"px",r.style.width=e.getTotalColumnsWidth()+"px",o.appendChild(r),t.appendChild(o),e.gridEl.appendChild(t),e.bodyInnerContainerEl=r,e.bodyInnerEl=o,e.bodyEl=t}updateVisibleHeight(){const e=this,t=e.store,{filters:o,rowGroups:r}=t;o.length||r.length?e.bodyInnerContainerEl.style.height=t.getDisplayedDataTotal()*e.rowHeight+"px":e.bodyInnerContainerEl.style.height=t.getDataTotal()*e.rowHeight+"px"}removeRowById(e){const t=this,o=t.renderedRowsIdMap.get(e);o?o.remove():console.warn(`Row El with id = ${e} was not found`),t.actualRowsIdSet.delete(e),t.renderedRowsIdMap.delete(e)}prepareConfig(e){const t=this;let o=[],r=[];if(e.columns){e.columns=Fancy.deepClone(e.columns);let s=0,l=!1;if(t.generateColumnIds(e.columns),"column"===e.rowGroupType&&(e.rowGroupColumn=e.rowGroupColumn||{}),e.columns.forEach((e=>{e.rowGroup&&(e.hidden=!0,o.push(e.index),void 0!==e.rowGroupOrder&&(l=l||[],l[e.rowGroupOrder]=e.index))})),l){const e=structuredClone(o).filter((e=>!l.includes(e)));o.forEach(((t,o)=>{void 0===l[o]&&(t=e.shift(),l[o]=t)})),l=l.concat(e),o=l}if(e.rowGroupColumn){let r=Object.assign({$rowGroups:o},t.$defaultRowGroupColumn);r.id=r.id||t.getAutoColumnIdSeed(),Object.assign(r,e.rowGroupColumn),t.$rowGroupColumn=r,o.length&&t.$rowGroupColumn&&e.columns.unshift(r)}e.columns.forEach((l=>{if("order"===l.type)(o.length||e.rowGroupBar)&&console.error("Order column is not supported for row grouping");t.prepareColumn(l,e.defaults),l.checkboxSelection&&(e.checkboxSelection=!0),l.agFn&&r.push({index:l.index,fn:l.agFn}),l.left=s,l.hidden||(s+=l.width)}))}const s={data:e.data,defaultRowGroupSort:e.defaultRowGroupSort||t.defaultRowGroupSort};return o.length&&(s.rowGroups=o,s.aggregations=r,s.rowGroupExpanded=e.rowGroupExpanded||[]),t.initStore(s),delete e.data,e}initStore(e){this.store=new Fancy.Store(e)}ons(){const e=this;e.debouceClearWheelScrollingFn=Fancy.debounce(e.clearWheelScrolling,50),e.bodyEl.addEventListener("wheel",e.onMouseWheel.bind(this)),e.touchScroller=new Fancy.TouchScroller(e.bodyEl,{onTouchScroll:e.onTouchScroll.bind(this)}),e.headerInnerContainerEl.addEventListener("click",e.onHeaderCellClick.bind(this)),e.headerInnerContainerEl.addEventListener("mousedown",e.onHeaderMouseDown.bind(this))}getTotalColumnsWidth(){return this.columns.reduce(((e,t)=>e+(t.hidden?0:t.width)),0)}reCalcColumnsPositions(){this.columns.reduce(((e,t)=>(t.left=e,e+(t.hidden?0:t.width))),0)}checkSize(){const e=this;let t=!1;e.width&&e.height;const o=e.containerEl.getBoundingClientRect();return e.width!==o.width&&(t=!0),e.height!==o.height&&(t=!0),e.width=o.width,e.height=o.height,t}setData(e){this.store.setData(e),this.reRender()}reRender(){const e=this;e.store,e.store.rowGroups.length?e.reConfigRowGroups():(e.terminateVisibleRows(),e.scroller.calcMaxScrollTop(),e.scroller.updateScrollTop(),e.scroller.calcViewRange(),e.scroller.setVerticalSize(),e.scroller.updateHorizontalScrollSize(),e.updateVisibleHeight(),e.scroller.calcVisibleRows(),e.renderVisibleRows(),e.store.memorizePrevRowIndexesMap())}destroy(){this.touchScroller.destroy(),this.gridEl.remove()}}window.Grid=c,Fancy.Grid=c})(),(()=>{const{ANIMATE_CELLS_POSITION:e,CELL:t,HEADER_CELL:o,FILTER_BAR_CELL:r}=Fancy.cls,s={showColumn(t,o){const r=this;o&&(r.animatingColumnsPosition=!0,r.gridEl.classList.add(e)),delete t.hidden,r.scroller.generateNewRange(),r.reCalcColumnsPositions(),r.updateWidth(),r.updateCellPositions(),o&&setTimeout((()=>{r.gridEl.classList.remove(e),delete r.animatingColumnsPosition}),300)},hideColumn(t,o){const r=this;if(!r.isPossibleToHideColumn())return console.warn("Hiding column was prevented because it requires at least 1 visible column"),!1;o&&!r.animatingColumnsPosition&&(r.animatingColumnsPosition=!0,r.gridEl.classList.add(e)),t.hidden=!0;const{columnsToRemove:s}=r.scroller.generateNewRange();return r.reCalcColumnsPositions(),r.updateWidth(),r.updateCellPositions(),o&&r.animatingColumnsPosition&&setTimeout((()=>{r.gridEl.classList.remove(e),delete r.animatingColumnsPosition}),300),{columnIndex:s[0]}},isPossibleToHideColumn(){const e=this.columns.reduce(((e,t)=>e+(t.hidden?1:0)),0);return this.columns.length-e!=1},removeColumn(e){const t=this,{columnIndex:o}=t.hideColumn(e,!1);t.columns.splice(o,1),t.clearColumFromLinks(e),delete t.$rowGroupColumn.elSortOrder,delete t.$rowGroupColumn.filterCellEl,delete t.$rowGroupColumn.headerCellEl,delete t.$rowGroupColumn.left,t.scroller.generateNewRange(!1),t.reSetVisibleHeaderColumnsIndex(),t.reSetVisibleBodyColumnsIndex(),t.reCalcColumnsPositions()},clearColumFromLinks(e){delete e.elFilter,delete e.elMenu,delete e.elSortAsc,delete e.elSortDesc,delete e.elSortOrder,delete e.filterCellEl,delete e.filterField,delete e.headerCellEl},getColumn(e){return this.columns.find((t=>t.index===e))},getAutoColumnIdSeed(){const e=this;return void 0===e.columnIdSeed?e.columnIdSeed=0:e.columnIdSeed++,e.columnIdSeed},generateColumnIds(e,t=!0){const o=this,r=new Map,s=new Map;return e.forEach((e=>{const t=(e.index||e.title||"").toLocaleLowerCase();if(e.id){let e=s.get(t);void 0===e&&(e=0),e++,s.set(t,e)}else{let r=s.get(t);void 0===r?(e.id=t||o.getAutoColumnIdSeed(),r=0):e.id=`${t}-${r}`,r++,s.set(t,r)}r.set(e.id,e)})),t&&(o.columnIdsMap=r,o.columnIdsSeedMap=s),{columnIdsMap:r,columnIdsSeedMap:s}},setColumns(t){const o=this;t=Fancy.deepClone(t),o.animatingColumnsPosition=!0,o.gridEl.classList.add(e),o.$setColumns(t),o.scroller.generateNewRange(!1),o.reCalcColumnsPositions(),o.updateWidth(),o.terminateNotExistedCells(),o.reSetVisibleHeaderColumnsIndex(),o.reSetVisibleBodyColumnsIndex(),o.renderMissedCells(),o.updateCellPositions(),setTimeout((()=>{o.gridEl.classList.remove(e),delete o.animatingColumnsPosition}),300)},renderMissedCells(){const e=this;let t=e.scroller.columnViewStart,o=e.scroller.columnViewEnd;const r=[];for(let s=t;s<=o;s++){const t=e.columns[s];t.hidden||(t.headerCellEl||r.push(s))}e.addColumnCells(r)},terminateNotExistedCells(){const e=this;e.headerEl.querySelectorAll(`.${o}`).forEach((o=>{const s=o.getAttribute("col-id"),l=e.columnIdsMap.get(s),n=e.scroller.isColumnVisible(l);if(!l||!n){o.remove(),l&&l.filterCellEl&&l.filterCellEl.remove();const n=e.filterBarEl?.querySelector?.(`.${r}[col-id="${s}"]`);n?.remove();e.bodyEl.querySelectorAll(`.${t}[col-id="${s}"]`).forEach((e=>{e.remove()}))}l&&!n&&e.clearColumFromLinks(l)}))},$setColumns(e){const t=this,o=new Map,r=new Set,{columnIdsMap:s,columnIdsSeedMap:l}=t.generateColumnIds(e,!1);t.columns.forEach((e=>{if(s.has(e.id)){const t=s.get(e.id);"number"==typeof t.width&&t.width!==e.width&&(e.width=t.width)}else r.add(e.id)}));const n=new Map;e.forEach(((e,r)=>{t.columnIdsMap.has(e.id)||(t.prepareColumn(e,t.defaults),o.set(e.id,e)),n.set(r,e.id)})),r.forEach((e=>{const o=t.columnIdsMap.get(e),r=(o.index||o.title||"").toLocaleLowerCase();t.columnIdsMap.delete(e);let s=t.columnIdsSeedMap.get(r);"number"==typeof s&&(s--,0===s?t.columnIdsSeedMap.delete(r):t.columnIdsSeedMap.set(r,s))})),o.forEach(((e,o)=>{t.columnIdsMap.set(o,e),t.columnIdsSeedMap.set(o,l.get(o))}));const i=[];n.forEach(((e,o)=>{const r=t.columnIdsMap.get(e);i[o]=r})),t.columns=i},prepareColumn(e,t={}){const o=this,r=o.store;switch(e.type){case"boolean":e.render=Fancy.render.boolean;break;case"currency":e.format=Fancy.format.currency,e.type="number",e.$type="currency";break;case"order":e.sortable=!1,e.render=Fancy.render.order,e.width=e.width||45,e.resizable=!1,e.menu=!1,e.draggable=!1,o.columnOrder=e,(r?.rowGroups.length||o?.rowGroupBar)&&console.error("Order column is not supported for row grouping")}void 0===e.width&&(e.width=o.defaultColumnWidth),e.minWidth&&e.width<e.minWidth&&(e.width=e.minWidth),e.title||(e.title=Fancy.capitalizeFirstLetter(e.index||"")),Object.keys(t).forEach((o=>{void 0===e[o]&&(e[o]=t[o])}))}};Object.assign(Grid.prototype,s)})(),(()=>{const{ANIMATE_CELLS_POSITION:e,HIDDEN:t,HEADER_CELL:o,HEADER_CELL_LABEL:r,HEADER_CELL_MENU:s,HEADER_CELL_SELECTION:l,HEADER_CELL_SORTABLE:n,HEADER_CELL_NOT_RESIZABLE:i,HEADER_CELL_TEXT:a,HEADER_FILTER_EL:d,HEADER_CELL_RESIZE:c,BODY:u,COLUMN_RESIZING:p,COLUMN_DRAGGING:h,COLUMNS_MENU:g,COLUMNS_MENU_ITEM:m,COLUMNS_MENU_ITEM_TEXT:w,FILTER_INDICATOR_CONTAINER:E,SORT_ASC:C,SORT_DESC:R,SORT_ORDER:f,SORT_INDICATOR_CONTAINER:L,INPUT_CHECKBOX:I,ROW_GROUP_BAR_ITEM_ACTIVE:G}=Fancy.cls,y={deltaStartColumnDrag:10,onHeaderMouseDown(e){e.preventDefault()},onHeaderCellClick(e){const t=this,l=e.target.closest(`.${r}`),n=e.target.closest(`.${s}`),i=e.shiftKey;if(!t.columnDragging){if(l){const e=l.closest(`.${o}`).getAttribute("col-index"),r=t.columns[e];if(!r.sortable||!r.type)return;switch(r.sort){case"ASC":i?t.multiSort(r.index,"DESC",r.type):t.sort(r.index,"DESC",r.type);break;case"DESC":t.clearSort(r.index,i);break;case void 0:i?t.multiSort(r.index,"ASC",r.type):t.sort(r.index,"ASC",r.type)}}if(n){const r=n.closest(`.${o}`).getAttribute("col-index"),s=t.columns[r];s.elMenuList?t.destroyHeaderCellMenuList(s):requestAnimationFrame((()=>{t.showHeaderCellMenuList(e,s,r)}))}}},renderVisibleHeaderCells(){const e=this;let t=e.scroller.columnViewStart,o=e.scroller.columnViewEnd;for(let r=t;r<=o;r++){if(e.columns[r].hidden)continue;const t=e.createHeaderCell(r);e.headerInnerContainerEl.appendChild(t)}},appendHeaderCell(e){const t=this.headerInnerContainerEl,o=this.createHeaderCell(e);t.appendChild(o)},createHeaderCell(e){const u=this,p=document.createElement("div"),h=u.columns[e],g=h.title;p.classList.add(o),h.sortable&&h.type&&p.classList.add(n),!1===h.resizable&&p.classList.add(i),p.setAttribute("col-index",e),p.setAttribute("col-id",h.id),p.style.width=h.width+"px",p.style.left=h.left+"px";const m=document.createElement("div");m.classList.add(r);const w=document.createElement("div");w.classList.add(a),w.innerHTML=g;const G=document.createElement("span");G.classList.add(E);const y=document.createElement("span");y.classList.add(d),Object.entries(h.filters||{}).length||y.classList.add(t),y.innerHTML=Fancy.svg.filter,G.appendChild(y),h.elFilter=y;const v=document.createElement("span");v.classList.add(L);const S=document.createElement("span");S.classList.add(f),h.sortOrder?S.innerHTML=h.sortOrder:S.classList.add(t),v.appendChild(S),h.elSortOrder=S;const x=document.createElement("span");x.classList.add(C),"ASC"!==h.sort&&x.classList.add(t),x.innerHTML=Fancy.svg.sortAsc,v.appendChild(x),h.elSortAsc=x;const D=document.createElement("span");D.classList.add(R),"DESC"!==h.sort&&D.classList.add(t),D.innerHTML=Fancy.svg.sortDesc,v.appendChild(D),h.elSortDesc=D;const b=document.createElement("div");b.classList.add(c),b.addEventListener("mousedown",u.onResizeMouseDown.bind(this)),m.appendChild(w),m.appendChild(G),m.appendChild(v);const F=document.createElement("div");if(F.classList.add(s),F.innerHTML=Fancy.svg.menu,h.elMenu=F,h.headerCheckboxSelection&&h.checkboxSelection){const e=document.createElement("div");e.classList.add(l);const t=document.createElement("input");t.classList.add(I),t.setAttribute("type","checkbox"),t.addEventListener("click",u.onHeaderCheckboxSelectionClick.bind(this)),e.appendChild(t),h.headerCheckboxSelectionEl=t,p.appendChild(e)}return p.appendChild(m),!1!==h.menu&&p.appendChild(F),!1!==h.resizable&&p.appendChild(b),p.addEventListener("mousedown",u.onCellMouseDown.bind(this)),h.headerCellEl=p,p},onCellMouseDown(e){const t=this;if(e.target.closest(`.${s}`))return;const r=e.target.classList.contains(o)?e.target:e.target.closest(`.${o}`),l=Number(r.getAttribute("col-index")),n=t.columns[l];!1!==n.draggable&&(t.columnDragDownX=e.pageX,t.columnDragDownY=e.pageY,t.columnDragMouseDownColumn=n,t.columnDragMouseDownColumnIndex=l,t.onColumnDragMouseMoveFn=t.onColumnDragMouseMove.bind(this),document.addEventListener("mousemove",t.onColumnDragMouseMoveFn),document.addEventListener("mouseup",(()=>{delete t.columnDragDownX,delete t.columnDragDownY,delete t.columnDragMouseDownColumn,delete t.debouceColumnDraggingFn,setTimeout((()=>{t.activeRowGroupBarItemEl&&t.activeRowGroupBarItemEl.classList.remove(G),t.gridEl.classList.remove(h),t.columnDragging?.dragColumnCellEl.remove(),delete t.columnDragging,t.$requiresReSetGroupColumn&&"column"===t.rowGroupType&&(delete t.$requiresReSetGroupColumn,1===t.rowGroupBarItemColumns.length&&setTimeout((()=>{t.$rowGroupColumn.hidden=!0,t.columns.unshift(t.$rowGroupColumn),t.scroller.generateNewRange(!1),t.reSetVisibleHeaderColumnsIndex(),t.showColumn(t.columns[0])}),1)),t.rowGroupBarItemColumns&&t.rowGroupBarItemColumns.length!==t.store.rowGroups.length&&t.reConfigRowGroups()}),1),document.removeEventListener("mousemove",t.onColumnDragMouseMoveFn)}),{once:!0}))},onResizeMouseDown(e){const t=this,r=e.target.closest(`.${o}`),s=Number(r.getAttribute("col-index")),l=t.columns[s];e.preventDefault(),e.stopPropagation(),!1!==l.resizable&&(t.columnResizing=!0,t.resizeDownX=e.pageX,t.resizeDownColumnWidth=l.width,t.resizeDownColumnIndex=s,t.onResizeMouseMoveFn=t.onResizeMouseMove.bind(this),document.addEventListener("mouseup",t.onResizeMouseUp.bind(this),{once:!0}),document.body.addEventListener("mousemove",t.onResizeMouseMoveFn),t.gridEl.classList.add(p),t.gridEl.style.cursor="ew-resize",t.gridEl.style.userSelect="none",t.gridEl.querySelectorAll(`.${o}`).forEach((e=>{e.style.cursor="ew-resize"})),t.gridEl.querySelectorAll(`.${u}`).forEach((e=>{e.style.cursor="ew-resize"})))},onResizeMouseUp(e){const t=this;t.columnResizing=!1,t.gridEl.classList.remove(p),t.gridEl.style.cursor="",t.gridEl.style.userSelect="",document.body.querySelectorAll(`.${o}`).forEach((e=>{e.style.cursor=""})),t.gridEl.querySelectorAll(`.${u}`).forEach((e=>{e.style.cursor=""})),document.body.removeEventListener("mousemove",t.onResizeMouseMoveFn)},onResizeMouseMove(e){const t=this,o=e.pageX-t.resizeDownX,r=t.columns[t.resizeDownColumnIndex],s=r.minWidth||t.minColumnWidth;let l=t.resizeDownColumnWidth+o;l<s&&(l=s),r.width=l,requestAnimationFrame((()=>{t.reCalcColumnsPositions(),t.updateCellPositions(t.resizeDownColumnIndex),t.updateWidth()}))},updateHeaderCells(){const e=this;let o=e.scroller.columnViewStart,r=e.scroller.columnViewEnd;for(let s=o;s<=r;s++){const o=e.columns[s];o.hidden||(Object.entries(o.filters||{}).length?o.elFilter.classList.remove(t):o.elFilter.classList.add(t),o.sortOrder?(o.elSortOrder.innerHTML=o.sortOrder,o.elSortOrder.classList.remove(t)):o.elSortOrder.classList.contains(t)||o.elSortOrder.classList.add(t),"ASC"===o.sort?o.elSortAsc.classList.remove(t):o.elSortAsc.classList.contains(t)||o.elSortAsc.classList.add(t),"DESC"===o.sort?o.elSortDesc.classList.remove(t):o.elSortDesc.classList.contains(t)||o.elSortDesc.classList.add(t))}},showHeaderCellMenuList(e,t,o){const r=this,s=document.createElement("div"),l=t.elMenu.getBoundingClientRect(),n=l.top-1+l.height,i=l.left;s.classList.add(g),s.classList.add("fg-theme-"+r.theme),s.style.top=`${n}px`,s.style.left=`${i}px`,s.innerHTML=r.columns.map(((e,t)=>e.$rowGroups?"":[`<div col-index="${t}" class="${m}">`,`<input type="checkbox" ${e.hidden?"":"checked"}>`,`<div class="${w}">${e.title}</div>`,"</div>"].join(""))).join(""),t.elMenuList=s,document.body.appendChild(s),setTimeout((()=>{s.style.opacity="1"}),0),s.addEventListener("click",r.onClickHeaderMenuItem.bind(this)),r.onDocClickForHeaderCellMenuFn=r.onDocClickForHeaderCellMenu.bind(this,t),document.addEventListener("mousedown",r.onDocClickForHeaderCellMenuFn)},onClickHeaderMenuItem(t){const o=this,r=t.target.closest(`.${m}`);if(r&&!o.animatingColumnsPosition){const s=r.querySelector("input"),l=Number(r.getAttribute("col-index")),n=o.columns[l],i="input"===t.target.tagName.toLowerCase();if(!o.isPossibleToHideColumn()&&(!i&&s.checked||i&&!s.checked))return i&&t.preventDefault(),void console.warn("Hiding column was prevented because it requires at least 1 visible column");o.animatingColumnsPosition=!0,o.gridEl.classList.add(e),i||(s.checked=!s.checked),s.checked?o.showColumn(n):o.hideColumn(n),setTimeout((()=>{o.gridEl.classList.remove(e),delete o.animatingColumnsPosition}),300)}},onDocClickForHeaderCellMenu(e,t){const o=this;t.target.closest(`.${g}`)||t.target.closest(`.${s}`)||o.destroyHeaderCellMenuList(e)},destroyHeaderCellMenuList(e){document.removeEventListener("mousedown",this.onDocClickForHeaderCellMenuFn),e.elMenuList?.remove(),delete e.elMenuList},reSetVisibleHeaderColumnsIndex(){const e=this,t=e.scroller.columnsViewRange;for(let o=0,r=t.length;o<r;o++){const r=t[o],s=e.columns[r],l=s.headerCellEl,n=s.filterCellEl;s.hidden||(l&&Number(l.getAttribute("col-index"))!==r&&l.setAttribute("col-index",r),n&&Number(n.getAttribute("col-index"))!==r&&n.setAttribute("col-index",r))}}};Object.assign(Grid.prototype,y)})(),(()=>{const{CELL:e,CELL_ORDER:t,CELL_WRAPPER:o,CELL_SELECTION:r,ROW:s,ROW_ODD:l,ROW_EVEN:n,ROW_SELECTED:i,ROW_GROUP:a,ROW_GROUP_VALUE_CELL:d,ROW_GROUP_CELL:c,ROW_GROUP_CELL_SELECTION:u,ROW_GROUP_CELL_VALUE:p,ROW_GROUP_CELL_AMOUNT:h,ROW_GROUP_CELL_EXPANDER:g,ROW_GROUP_EXPANDED_CELL:m,ROW_HOVER:w,INPUT_CHECKBOX:E,SVG_ITEM:C,SVG_CHEVRON_RIGHT:R}=Fancy.cls,f={addColumnCells(e=[]){const t=this,o=t.scroller.getStartRow(),r=t.scroller.getEndRow();e.forEach((e=>{let s=o;for(t.appendHeaderCell(e),t.filterBar&&t.appendFilterBarCell(e);s<r;s++)t.appendCell(s,e)}))},appendCell(e,t){const o=this,r=o.store.getItemByRowIndex(e),s=o.renderedRowsIdMap.get(r.id);if(s.classList.contains(a)){const l=o.columns[t];if("column"===o.rowGroupType&&l.$rowGroups){const l=o.createCellGroupTypeColumn(e,r,t);s.appendChild(l)}return}const l=o.createCell(e,t);s.appendChild(l)},createCell(t,s){const l=this,n=l.store,i=n.getItemByRowIndex(t),a=l.columns[s];let c,u=i[a.index];const p=document.createElement("div"),h={item:i,column:a,rowIndex:t,columnIndex:s,value:u,cell:p};if("currency"===a.$type&&(a.currency&&(h.currency=a.currency),void 0!==a.minDecimal&&(h.minDecimal=a.minDecimal),void 0!==a.maxDecimal&&(h.maxDecimal=a.maxDecimal)),p.setAttribute("col-index",s),p.setAttribute("col-id",a.id),p.classList.add(e),p.style.width=a.width+"px",p.style.left=a.left+"px",a.cellStyle){let e;switch(typeof a.cellStyle){case"function":e=a.cellStyle(h)||{};break;case"object":e=a.cellStyle}for(const t in e)p.style[t]=e[t]}if(a.cellCls)if("string"==typeof a.cellCls)p.classList.add(a.cellCls);else if(Array.isArray(a.cellCls))p.classList.add(...a.cellCls);else if("function"==typeof a.cellCls){let e=a.cellCls(h);"string"==typeof e&&(e=[e]),e&&p.classList.add(...e)}if(a.cellClsRules)for(const e in a.cellClsRules){(0,a.cellClsRules[e])(h)&&p.classList.add(e)}if(a.format&&(u=a.format(h)),c=a.render?a.render(h):u,(a.$rowGroups||a.rowGroupIndent)&&p.classList.add(d),a.checkboxSelection){const e=document.createElement("div");e.classList.add(o),a.rowGroupIndent&&e.style.setProperty("--grid-group-level",`${n.rowGroups.length+1}`);const t=l.generateRowGroupCheckBoxEl(i);t.addEventListener("click",this.onRowCellSelectionClick.bind(this)),e.appendChild(t);const s=l.generateSimpleValueEl(c);e.appendChild(s),p.appendChild(e),p.classList.add(r)}else if(a.$rowGroups){const e=document.createElement("div");e.classList.add(o),a.rowGroupIndent&&e.style.setProperty("--grid-group-level",`${n.rowGroups.length}`);const t=document.createElement("span");t.classList.add("fg-cell-value"),""===c&&(c="&nbsp;"),t.innerHTML=c??"&nbsp;",e.appendChild(t),p.appendChild(e)}else void 0!==c&&(""===c&&(c="&nbsp;"),p.innerHTML=c??"&nbsp;");return p},createCellGroupTypeColumn(t,o,r){const s=this,l=s.columns[r];if(l.$rowGroups){const e=s.generateGroupCell(t,o,l);return e.setAttribute("col-index",r),e.setAttribute("col-id",l.id),e.style.left=l.left+"px",e.style.width=l.width+"px",e}{const l=s.columns[r];let n=o.$agValues[l.index]||"";const i=document.createElement("div");let a;return l.format&&(n=l.format({item:o,column:l,rowIndex:t,columnIndex:r,value:n,cell:i})),a=l.render?l.render({item:o,column:l,rowIndex:t,columnIndex:r,value:n,cell:i}):n,i.setAttribute("col-index",r),i.setAttribute("col-id",l.id),i.classList.add(e),i.style.width=l.width+"px",i.style.left=l.left+"px",void 0!==a&&(i.innerHTML=a),i}},createCellGroupTypeRow(e,t){const o=this.generateGroupCell(e,t);return o.style.left="0px",o},generateSimpleValueEl(e){const t=document.createElement("span");return t.classList.add("fg-cell-value"),""===e&&(e="&nbsp;"),t.innerHTML=e??"&nbsp;",t},generateGroupCell(e,t,o={}){const s=this,l=document.createElement("div");l.classList.add(c),t.expanded&&l.classList.add(m);const n=s.generateRowGroupExpanderEl(t);if(l.appendChild(n),s.checkboxSelection||o.checkboxSelection){const e=s.generateRowGroupSelectionEl(t);l.appendChild(e),l.classList.add(r)}const i=s.generateValueEl(t,e);l.appendChild(i);const a=s.generateAmountEl(t);return l.appendChild(a),l},generateAmountEl(e){const t=document.createElement("span");return t.classList.add(h),t.innerHTML=` (${e.amount})`,t},generateValueEl(e,t){const o=e.$rowDisplayGroupValue,r=document.createElement("span");if(r.classList.add(p),this.groupValueRender){const s=this.groupValueRender({el:r,value:o,item:e,rowIndex:t});s&&(r.innerHTML=s)}else r.innerHTML=o;return r},generateRowGroupExpanderEl(e){const t=Fancy.svg.chevronRight,o=document.createElement("span");return o.classList.add(g,C,R),o.style.setProperty("--grid-group-level",e.$groupLevel),o.innerHTML=t,o.addEventListener("click",this.onRowGroupExpanderClick.bind(this)),o},generateRowGroupCheckBoxEl(e){const t=e.$selected||!1,o=document.createElement("input");return o.classList.add(E),o.setAttribute("type","checkbox"),o.checked=t,o},generateRowGroupSelectionEl(e){const t=document.createElement("span"),o=this.generateRowGroupCheckBoxEl(e);return o.addEventListener("click",this.onRowGroupCellSelectionClick.bind(this)),t.classList.add(u),t.appendChild(o),t},removeColumnCells(e=[]){const t=this;e.forEach((e=>{const o=t.headerEl.querySelector(`[col-index="${e}"]`);if(o){if(o.remove?.(),t.filterBar){const o=t.filterBarEl.querySelector(`[col-index="${e}"]`);o.remove?.()}t.renderedRowsIdMap.forEach((t=>{if(t.classList.contains(a))return;const o=t.querySelector(`[col-index="${e}"]`);o?.remove()}))}}))},renderRow(e,t,o={}){const r=this,a=document.createElement("div");if(!t)return void console.warn(`row ${e} does not exist`);const d={rowIndex:e,item:t};a.classList.add(s,e%2==1?l:n),r.applyExtraRowStyles(a,d),t.$selected&&a.classList.add(i),a.style.transform=`translateY(${e*r.rowHeight}px)`;for(const e in o)a.style[e]=o[e];a.setAttribute("row-id",t.id),a.addEventListener("mouseenter",this.onRowMouseEnter.bind(this));let c=r.scroller.columnViewStart,u=r.scroller.columnViewEnd;for(let t=c;t<=u;t++){const o=r.createCell(e,t);r.columns[t].hidden||a.appendChild(o)}return r.bodyInnerContainerEl.appendChild(a),r.renderedRowsIdMap.set(t.id,a),a},applyExtraRowStyles(e,t){const o=this;if(o.rowStyle&&"function"==typeof o.rowStyle){const r=o.rowStyle(t)||{};for(const t in r)e.style[t]=r[t]}if(o.rowCls&&"function"==typeof o.rowCls){let r=o.rowCls(t)||[];"string"==typeof r&&(r=[r]),e.classList.add(...r)}if(o.rowClsRules&&"object"==typeof o.rowClsRules)for(const r in o.rowClsRules){(0,o.rowClsRules[r])(t)&&e.classList.add(r)}},renderRowGroup(e,t,o={}){const r=this,s=document.createElement("div"),d=r.rowGroupType;if(t){s.classList.add(a,e%2==1?l:n),t.$selected&&s.classList.add(i),s.style.transform=`translateY(${e*r.rowHeight}px)`;for(const e in o)s.style[e]=o[e];if(s.setAttribute("row-id",t.id),s.setAttribute("row-group",t.$rowGroupValue.replaceAll("-","$").split("/").join("-")),s.addEventListener("mouseenter",this.onRowMouseEnter.bind(this)),"column"===d){let o=r.scroller.columnViewStart,l=r.scroller.columnViewEnd;for(let n=o;n<=l;n++){if(!r.columns[n].hidden){const o=r.createCellGroupTypeColumn(e,t,n);s.appendChild(o)}}}else if("row"===d){const o=r.createCellGroupTypeRow(e,t);s.appendChild(o)}return r.bodyInnerContainerEl.appendChild(s),r.renderedRowsIdMap.set(t.id,s),s}console.warn(`row ${e} does not exist`)},renderRowOnPrevPosition(e,t){const o=this,r=document.createElement("div"),a=o.store.prevIdRowIndexesMap.get(e.id),d=e.rowIndex;if(!e)return void console.warn(`row ${e.index} does not exist`);let c;c=t?o.getSmoothPositionY(e,!0):a*o.rowHeight,e.$selected&&r.classList.add(i);const u={rowIndex:d,item:e};r.classList.add(s,d%2==1?l:n),o.applyExtraRowStyles(r,u),r.style.transform=`translateY(${c}px)`,r.setAttribute("row-id",e.id),r.addEventListener("mouseenter",this.onRowMouseEnter.bind(this));let p=o.scroller.columnViewStart,h=o.scroller.columnViewEnd;for(let e=p;e<=h;e++){if(o.columns[e].hidden)continue;const t=o.createCell(d,e);r.appendChild(t)}o.bodyInnerContainerEl.appendChild(r),o.renderedRowsIdMap.set(e.id,r)},updateCellPositions(t){const o=this;let r=o.scroller.columnViewStart,s=o.scroller.columnViewEnd;void 0!==t&&r<t&&(r=t);for(let e=r;e<=s;e++){const t=o.columns[e];t.hidden||(t.headerCellEl||o.appendHeaderCell(e),t.headerCellEl.style.left=t.left+"px",t.headerCellEl.style.width=t.width+"px",t.filterCellEl&&(t.filterCellEl.style.left=t.left+"px",t.filterCellEl.style.width=t.width+"px"))}o.renderedRowsIdMap.forEach(((t,r)=>{if(t.querySelectorAll(`.${e}`).forEach((e=>{const t=e.getAttribute("col-index"),r=o.columns[t];e.style.left=r.left+"px",e.style.width=r.width+"px"})),"column"===o.rowGroupType){t.querySelectorAll(`.${c}`).forEach((e=>{const t=e.getAttribute("col-index"),r=o.columns[t];e.style.left=r.left+"px",e.style.width=r.width+"px"}))}}))},renderVisibleRows(){const e=this,t=e.scroller.getStartRow(),o=e.scroller.getEndRow();e.actualRowsIdSet=new Set;let r=t;for(;r<o;r++){const t=e.store.getItemByRowIndex(r);t?(e.renderedRowsIdMap.has(t.id)||(t.$isGroupRow?e.renderRowGroup(r,t):e.renderRow(r,t)),e.actualRowsIdSet.add(t.id)):console.warn(`Item with index equals to ${r} does not exist`)}},terminateVisibleRows(){const e=this;e.renderedRowsIdMap.forEach(((t,o)=>{e.removeRowById(o)}))},fakeHideRow(e){const t=this.renderedRowsIdMap.get(e.id);t?t.style.opacity="0":console.warn(`Row el for row index ${e.rowIndex} does not exist`)},fakeRowPosition(e){const o=this,r=o.renderedRowsIdMap.get(e.id);if(!r)return void console.warn(`Row el for row index ${e.rowIndex} does not exist`);const s=o.getSmoothPositionY(e);if(r.style.transform=`translateY(${s}px)`,o.columnOrder){const o=r.querySelector(`.${t}`);o&&(o.innerHTML=e.rowIndex+1)}},getSmoothPositionY(e,t){const o=this,r=o.rowHeight*o.scroller.bufferRows;let s=e.rowIndex;t&&(s=o.store.prevIdRowIndexesMap.get(e.id));let l=s*o.rowHeight;return l<o.scroller.scrollTop-r?l=o.scroller.scrollTop-r:l>o.scroller.scrollTop+o.height+r&&(l=o.scroller.scrollTop+o.height+r),l},updateRowPosition(e){const t=this.renderedRowsIdMap.get(e.id);t?t.style.transform=`translateY(${e.rowIndex*this.rowHeight}px)`:console.warn(`Row el for row index ${e.rowIndex} does not exist`)},removeNotNeededRows(){const e=this;e.renderedRowsIdMap.forEach(((t,o)=>{e.actualRowsIdSet.has(o)||e.removeRowById(o)}))},onRowMouseEnter(e){this.columnResizing||(e.target.classList.add(w),e.target.addEventListener("mouseleave",this.onRowMouseLeave.bind(this),{once:!0}))},onRowMouseLeave(e){e.target.classList.remove(w)},onRowGroupExpanderClick(e,t){const o=this;if(o.grouping)return;const r=e.target.closest(`.${c}`),s=r.closest(`.${a}`).getAttribute("row-group").replaceAll("-","/").replaceAll("$","-");r.classList.contains(m)?o.collapse(s):o.expand(s)},updateRowGroupCellExpandedCls(e){const t=this.bodyEl.querySelector(`div[row-group="${e.replaceAll("-","$").replaceAll("/","-")}"] .${c}`);t.classList.contains(m)?t.classList.remove(m):t.classList.add(m)},updateAllRowGroupCellsExtendedCls(){const e=this;e.bodyEl.querySelectorAll(`.${a}`).forEach((t=>{const o=t.getAttribute("row-group").replaceAll("-","/").replaceAll("$","-"),r=t.querySelector(`.${c}`),s=e.store.expandedGroups[o],l=r.classList.contains(m);s&&!l?r.classList.add(m):!s&&l&&r.classList.remove(m)}))},reSetVisibleBodyColumnsIndex(t,o,r){const s=this,l={},n={};if(void 0!==t){for(let r=t;r<=o;r++){const t=s.bodyEl.querySelectorAll(`.${e}[col-index="${r}"]`);if(l[r]=t,"column"===s.rowGroupType){const e=s.bodyEl.querySelectorAll(`.${c}[col-index="${r}"]`);e.length&&(n[r]=e)}}for(let e=t,s=0;e<=o;e++,s++){const e=r[s],o=t+s;l[e].forEach((e=>{e.setAttribute("col-index",o)})),n[e]?.forEach((e=>{e.setAttribute("col-index",o)}))}}else{const t=s.scroller.columnsViewRange;for(let o=0,r=t.length;o<r;o++){const r=t[o],l=s.columns[r];if(s.bodyEl.querySelectorAll(`.${e}[col-id="${l.id}"]`).forEach((e=>{Number(e.getAttribute("col-index"))!==r&&e.setAttribute("col-index",r)})),"column"===s.rowGroupType){s.bodyEl.querySelectorAll(`.${c}[col-index="${o}"]`).forEach((e=>{Number(e.getAttribute("col-index"))!==r&&e.setAttribute("col-index",r)}))}}}}};Object.assign(Grid.prototype,f)})(),(()=>{const e={initScroller(){this.scroller=new Fancy.Scroller({grid:this})},onMouseWheel(e){const t=this;let o=!1;t.wheelScrolling=!0,Math.abs(e.deltaY)>Math.abs(e.deltaX)?(o=t.scroller.deltaChange(e.wheelDelta),t.bodyInnerEl.scrollTop=t.scroller.scrollTop):(o=t.scroller.horizontalDeltaChange(e.wheelDelta),t.bodyInnerEl.scrollLeft=t.scroller.scrollLeft),o&&e.preventDefault(),cancelAnimationFrame(t.animationRenderId),t.animationRenderId=requestAnimationFrame((()=>{t.renderVisibleRows()})),cancelAnimationFrame(t.animationRemoveId),t.animationRemoveId=requestAnimationFrame((()=>{t.removeNotNeededRows()})),t.debouceClearWheelScrollingFn()},onTouchScroll(e){const t=this;let o=!1;t.wheelScrolling=!0,Math.abs(e.deltaY)>Math.abs(e.deltaX)?(o=t.scroller.deltaChange(e.deltaY),t.bodyInnerEl.scrollTop=t.scroller.scrollTop):e.deltaX&&(o=t.scroller.horizontalDeltaChange(e.deltaX),t.bodyInnerEl.scrollLeft=t.scroller.scrollLeft),o&&e.preventDefault?.(),cancelAnimationFrame(t.animationRenderId),t.animationRenderId=requestAnimationFrame((()=>{t.renderVisibleRows()})),cancelAnimationFrame(t.animationRemoveId),t.animationRemoveId=requestAnimationFrame((()=>{t.removeNotNeededRows()})),t.debouceClearWheelScrollingFn()},clearWheelScrolling(){delete this.wheelScrolling}};Object.assign(Grid.prototype,e)})(),(()=>{const e={sort(e,t="ASC",o="string",r){const s=this;if(s.sorting)return;s.sorting=!0;let l={};s.store.sort(e,t,o,r),r&&s.store.sorters.forEach(((e,t)=>{l[e.index]=t+1})),s.columns.forEach((n=>{n.index===e?(n.sort=t,n.type&&(o=n.type),r&&1!==s.store.sorters.length?n.sortOrder=l[n.index]:delete n.sortOrder):(r||delete n.sort,l[n.index]?n.sortOrder=l[n.index]:delete n.sortOrder)})),s.renderVisibleRowsAfterSort(),s.store.memorizePrevRowIndexesMap(),s.updateHeaderCells()},multiSort(e,t,o){this.sort(e,t,o,!0)},clearSort(e,t){const o=this;let r=0;for(;r<o.columns.length;r++){const s=o.columns[r];e&&t?s.index===e&&(delete s.sort,delete s.sortOrder):(delete s.sort,delete s.sortOrder)}o.store.clearSort(e,t),o.renderVisibleRowsAfterSort(),o.store.memorizePrevRowIndexesMap(),o.updateHeaderCells()},renderVisibleRowsAfterSort(){const e=this,t=e.scroller.getStartRow(),o=e.scroller.getEndRow();e.actualRowsIdSet=new Set;let r=t;for(;r<o;r++){const t=e.store.getItemByRowIndex(r);t?(e.renderedRowsIdMap.has(t.id)||e.renderRowOnPrevPosition(t,!0),e.actualRowsIdSet.add(t.id)):console.warn(`Item with index equals to ${r} does not exist`)}const s=[];requestAnimationFrame((()=>{requestAnimationFrame((()=>{e.renderedRowsIdMap.forEach(((t,o)=>{const r=e.store.idItemMap.get(o);e.actualRowsIdSet.has(r.id)||s.push(r),e.fakeRowPosition(r)})),clearTimeout(e.timeOutRemoveRows),e.timeOutRemoveRows=setTimeout((()=>{s.forEach((t=>{e.removeRowById(t.id)})),e.sorting=!1}),500)}))}))}};Object.assign(Grid.prototype,e)})(),(()=>{const{FILTER_BAR:e,FILTER_BAR_CELL:t,FILTER_BAR_INNER:o,FILTER_BAR_INNER_CONTAINER:r}=Fancy.cls,s={renderVisibleFilterBarCells(){const e=this;let t=e.scroller.columnViewStart,o=e.scroller.columnViewEnd;for(let r=t;r<=o;r++){if(e.columns[r].hidden)continue;const t=e.createFilterBarCell(r);e.filterBarInnerContainerEl.appendChild(t)}},renderFilterBar(){const t=this,s=document.createElement("div");s.classList.add(e),s.style.height=this.headerRowHeight+1+"px";const l=document.createElement("div");l.classList.add(o),l.style.width=t.getTotalColumnsWidth()+t.scroller.scrollBarWidth+"px";const n=document.createElement("div");n.classList.add(r),n.style.height=t.headerRowHeight+"px",n.style.width=t.getTotalColumnsWidth()+"px",l.appendChild(n),s.appendChild(l),t.gridEl.appendChild(s),t.filterBarInnerContainerEl=n,t.filterBarInnerEl=l,t.filterBarEl=s},createFilterBarCell(e){const o=this,r=document.createElement("div"),s=o.columns[e];if(r.classList.add(t),r.setAttribute("col-index",e),r.setAttribute("col-id",s.id),r.style.width=s.width+"px",r.style.left=s.left+"px",s.filter){const e=Object.entries(s.filters||{});let t="",l="";e.length&&(t=e[0][0],l=e[0][1].value);const n=new Fancy.FilterField({renderTo:r,onChange:o.onFilterFieldChange.bind(this),column:s,sign:t,value:l});s.filterField=n}return s.filterCellEl=r,r},onFilterFieldChange(e,t,o){const r=this;o.filters={},""===e?r.clearFilter(o.index,t):r.filter(o.index,e,t)},appendFilterBarCell(e){const t=this.filterBarInnerContainerEl,o=this.createFilterBarCell(e);t.appendChild(o)},clearFilter(e,t){const o=this,r=o.store;if(r.rowGroups.length)return r.clearFilterForGrouping(e,t),o.updateAfterGrouping(),o.updateRowGroupAmount(),void o.updateHeaderCells();r.clearFilter(e,t),o.columns.forEach((o=>{o.index===e&&(t&&o.filters?delete o.filters[t]:delete o.filters)})),o.updateAfterFilter()},filter(e,t,o="="){const r=this,s=r.store;if(s.rowGroups.length)return r.filterForRowGrouping(e,t,o),r.updateAfterGrouping(),r.updateRowGroupAmount(),void r.updateHeaderCells();s.filter(e,t,o),r.updateFiltersInColumns(e,t,o),r.updateAfterFilter()},filterForRowGrouping(e,t,o="="){this.store.filterForRowGrouping(e,t,o),this.updateFiltersInColumns(e,t,o)},updateFiltersInColumns(e,t,o){this.columns.forEach((r=>{r.index===e&&(r.filters=r.filters||{},r.filters[o]=r.filters[o]||{},r.filters[o].value=t)}))},updateAfterFilter(){const e=this;e.scroller.calcMaxScrollTop(),e.scroller.updateScrollTop(),e.scroller.calcViewRange(),e.scroller.setVerticalSize(),e.scroller.updateHorizontalScrollSize(),e.updateVisibleHeight(),e.renderVisibleRowsAfterFilter(),e.store.memorizePrevRowIndexesMap(),e.updateHeaderCells()},renderVisibleRowsAfterFilter(){const e=this,t=e.scroller.getStartRow(),o=e.scroller.getEndRow();e.actualRowsIdSet=new Set;let r=t;for(;r<o;r++){const t=e.store.getItemByRowIndex(r);t?(e.renderedRowsIdMap.has(t.id)||e.renderRowOnPrevPosition(t,!0),e.actualRowsIdSet.add(t.id)):console.warn(`Item with index equals to ${r} does not exist`)}const s=[];requestAnimationFrame((()=>{requestAnimationFrame((()=>{e.renderedRowsIdMap.forEach(((t,o)=>{const r=e.store.idItemMap.get(o);e.actualRowsIdSet.has(r.id)?e.fakeRowPosition(r):(s.push(r),e.fakeHideRow(r))})),clearTimeout(e.timeOutRemoveRows),e.timeOutRemoveRows=setTimeout((()=>{s.forEach((t=>{e.removeRowById(t.id)})),e.filtering=!1}),500)}))}))}};Object.assign(Grid.prototype,s)})(),(()=>{const{ROW_GROUP:e,ROW_GROUP_CELL_AMOUNT:t}=Fancy.cls,o={toggleExpand(e){const t=this;t.grouping||(t.store.toggleExpand(e),t.updateAfterGrouping())},expand(e){const t=this;t.grouping||(t.grouping=!0,t.store.filters.length?t.store.expandForFiltering(e):t.store.expand(e),t.updateRowGroupCellExpandedCls(e),t.updateAfterGrouping())},expandAll(){const e=this;e.grouping||(e.grouping=!0,e.store.expandAll(),e.updateAllRowGroupCellsExtendedCls(),e.updateAfterGrouping())},collapse(e){const t=this;t.grouping||(t.grouping=!0,t.store.filters.length?t.store.collapseForFiltering(e):t.store.collapse(e),t.updateRowGroupCellExpandedCls(e),t.updateAfterGrouping())},collapseAll(){const e=this;e.grouping||(e.grouping=!0,e.store.collapseAll(),e.updateAllRowGroupCellsExtendedCls(),e.updateAfterGrouping())},updateAfterGrouping(){const e=this;e.scroller.calcMaxScrollTop(),e.scroller.updateScrollTop(),e.scroller.calcViewRange(),e.scroller.setVerticalSize(),e.scroller.updateHorizontalScrollSize(),e.updateVisibleHeight(),e.renderVisibleRowsAfterGrouping(),e.store.memorizePrevRowIndexesMap()},renderVisibleRowsAfterGrouping(){const e=this,t=e.scroller.getStartRow(),o=e.scroller.getEndRow(),r=[];e.actualRowsIdSet=new Set;let s=t;for(;s<o;s++){const t=e.store.getItemByRowIndex(s);t?(e.renderedRowsIdMap.has(t.id)||(t.$isGroupRow?r.push(e.renderRowGroup(s,t,{"z-index":0,opacity:0})):r.push(e.renderRow(s,t,{"z-index":0,opacity:0}))),e.actualRowsIdSet.add(t.id)):console.warn(`Item with index equals to ${s} does not exist`)}const l=[];requestAnimationFrame((()=>{requestAnimationFrame((()=>{e.renderedRowsIdMap.forEach(((t,o)=>{const r=e.store.idItemMap.get(o);e.actualRowsIdSet.has(r.id)||l.push(r),e.updateRowPosition(r),e.fakeRowPosition(r)})),l.forEach((t=>{const o=e.renderedRowsIdMap.get(t.id);o.style.zIndex="0",o.style.opacity="0"})),clearTimeout(e.timeOutRemoveRows),r.forEach((e=>{e.style.opacity=1})),e.timeOutRemoveRows=setTimeout((()=>{l.forEach((t=>{e.removeRowById(t.id)})),r.forEach((e=>{e.style["z-index"]="",e.style.opacity=""})),e.grouping=!1}),500)}))}))},updateRowGroupAmount(){const o=this.store;this.bodyEl.querySelectorAll(`.${t}`).forEach((t=>{const r=t.closest(`.${e}`).getAttribute("row-group").replaceAll("-","/").replaceAll("$","-"),s=o.groupDetailsForFiltering[r];if(o.filters.length&&!s)return;let l=o.filters.length?s.amount:o.groupDetails[r].amount;l=` (${l})`;Number(t.innerHTML)!==l&&(t.innerHTML=l)}))},reConfigRowGroups(){const e=this,t=e.store,o=[];e.grouping=!0,e.terminateVisibleRows(),e.rowGroupBarItemColumns.forEach((e=>{o.push(e.index)})),t.reConfigRowGroups(o),e.scroller.calcMaxScrollTop(),e.scroller.updateScrollTop(),e.scroller.calcViewRange(),e.scroller.setVerticalSize(),e.scroller.updateHorizontalScrollSize(),e.updateVisibleHeight(),e.scroller.calcVisibleRows(),e.renderVisibleRows(),e.store.memorizePrevRowIndexesMap(),e.grouping=!1}};Object.assign(Grid.prototype,o)})(),(()=>{const{COLUMN_DRAGGING:e,ROW_GROUP_BAR:t,ROW_GROUP_BAR_EMPTY_TEXT:o,ROW_GROUP_BAR_ITEM_CONTAINER:r,ROW_GROUP_BAR_ITEM:s,ROW_GROUP_BAR_ITEM_TEXT:l,ROW_GROUP_BAR_ITEM_ACTIVE:n,SVG_ITEM:i,SVG_GROUP:a,SVG_DRAG:d,SVG_CHEVRON_RIGHT:c,SVG_REMOVE:u}=Fancy.cls,p={renderRowGroupBar(){const e=this,r=document.createElement("div");r.classList.add(t),r.style.height=this.headerRowHeight+1+"px";const s=Fancy.svg.group,l=document.createElement("span");l.classList.add(i,a),l.innerHTML=s,r.appendChild(l);const n=document.createElement("span");n.classList.add(o),n.innerHTML="Drag columns here to generate row groups",r.appendChild(n),e.gridEl.appendChild(r),e.rowGroupBarEmptyTextEl=n,e.rowGroupBarEl=r,e.renderRowGroupBarItems()},renderRowGroupBarItems(){const e=this;e.store.rowGroups.forEach((t=>{const o=e.getColumn(t);e.addGroupInBar(o,!1)}))},onRowGroupBarMouseEnter(e){this.addGroupInBar(this.columnDragging.column)},addGroupInBar(e,t=!0){const o=this,r=o.generateRowGroupBarItemEl(e);t&&r.classList.add(n),o.activeRowGroupBarItemEl=r,o.rowGroupBarItems=o.rowGroupBarItems||[],o.rowGroupBarItemColumns=o.rowGroupBarItemColumns||[],o.rowGroupBarEl.appendChild(r),o.rowGroupBarItems.push(r),o.rowGroupBarItemColumns.push(e),o.columnDragging&&"column"===o.rowGroupType&&o.rowGroupBarItemColumns.length<=1&&(o.$requiresReSetGroupColumn=!0),o.rowGroupBarEmptyTextEl.style.setProperty("display","none")},generateRowGroupBarItemEl(e){const t=this,o=document.createElement("div");o.classList.add(r),o.setAttribute("row-group-order-index",String(t.rowGroupBarItems?.length||0));const n=document.createElement("span");n.classList.add(s);const a=document.createElement("span");a.classList.add(i,d),a.innerHTML=Fancy.svg.groupCellDrag,n.appendChild(a),a.addEventListener("mousedown",t.onRowGroupBarItemDragElMouseDown.bind(t));const p=document.createElement("span");p.classList.add(l),p.innerHTML=e.title,n.appendChild(p);const h=document.createElement("span");if(h.classList.add(i,u),h.innerHTML=Fancy.svg.remove,h.addEventListener("click",t.onRowGroupBarItemRemoveClick.bind(t)),n.appendChild(h),t.rowGroupBarItems?.length){const e=Fancy.svg.chevronRight,r=document.createElement("span");r.classList.add(i,c),r.innerHTML=e,t.rowGroupBarSeparator&&o.appendChild(r)}return o.appendChild(n),o},onRowGroupBarItemDragElMouseDown(t){const o=this,s=t.target.closest(`.${r}`),l=Number(s.getAttribute("row-group-order-index")),i=o.rowGroupBarItemColumns[l];s.classList.add(n),o.activeRowGroupBarItemEl=s,o.columnDragging={column:i,inBar:!0,dragColumnCellEl:o.createDragColumnCellEl(i),rowGroupBarElRect:o.getRowGroupBarElRect(),dragItemFromRowGroupBar:!0,rowGroupBarItemsRect:o.getRowGroupBarItemsRect(),originalRowGroupItemOrderIndex:l},o.gridEl.classList.add(e),o.onColumnDragMouseMoveFn=o.onColumnDragMouseMove.bind(this),document.body.addEventListener("mousemove",o.onColumnDragMouseMoveFn),document.addEventListener("mouseup",(t=>{const r=o.columnDragging,{dragItemFromRowGroupBar:s,changedRowGroupItemOrderIndex:l,originalRowGroupItemOrderIndex:i,inBar:a}=o.columnDragging;s&&!a?(o.showColumn(r.column,!0),o.removeGroupInBar(r.column),setTimeout((()=>{o.reConfigRowGroups(),0===o.store.rowGroups.length&&o.$rowGroupColumn&&o.removeColumn(o.$rowGroupColumn)}),1)):(o.activeRowGroupBarItemEl.classList.remove(n),void 0!==l&&l!==i&&setTimeout((()=>{o.reConfigRowGroups()}),1)),o.gridEl.classList.remove(e),r?.dragColumnCellEl.remove(),delete o.columnDragMouseDownColumn,delete o.columnDragging,delete o.activeRowGroupBarItemEl,document.body.removeEventListener("mousemove",o.onColumnDragMouseMoveFn)}),{once:!0})},onRowGroupBarMouseLeave(e){this.removeGroupInBar()},removeGroupInBar(e){const t=this;if(e){const o=t.rowGroupBarItemColumns.findIndex((t=>t.id===e.id)),r=t.rowGroupBarItems.splice(o,1)[0];t.rowGroupBarItemColumns.splice(o,1),r.remove(),t.reSetRowGroupOrderIndex()}else{const e=t.rowGroupBarItems.pop();t.rowGroupBarItemColumns.pop(),e.remove()}delete t.activeRowGroupBarItemEl,t.rowGroupBarItems&&0!==t.rowGroupBarItems?.length||t.rowGroupBarEmptyTextEl.style.setProperty("display","")},onRowGroupBarItemRemoveClick(e){const t=this,o=e.target.closest(`.${r}`),s=Number(o.getAttribute("row-group-order-index")),l=t.rowGroupBarItems.splice(s,1)[0],n=t.rowGroupBarItemColumns.splice(s,1)[0];l.remove(),t.showColumn(n,!0),delete t.activeRowGroupBarItemEl,t.rowGroupBarItems&&0!==t.rowGroupBarItems?.length||t.rowGroupBarEmptyTextEl.style.setProperty("display",""),t.reSetRowGroupOrderIndex(),t.reConfigRowGroups(),0===t.store.rowGroups.length&&t.$rowGroupColumn&&t.removeColumn(t.$rowGroupColumn)},reSetRowGroupOrderIndex(){this.rowGroupBarItems.forEach(((e,t)=>{e.setAttribute("row-group-order-index",t)}))},getRowGroupBarElRect(){const e=this.rowGroupBarEl.getBoundingClientRect();return{x:e.x,y:e.y,bottomX:e.x+e.width,rightY:e.y+e.height}},getRowGroupBarItemsRect(){const e=[];return this.rowGroupBarItems?.forEach((t=>{const o=t.getBoundingClientRect();e.push({x:o.x,y:o.y,rightX:o.x+o.width,bottomY:o.y+o.height})})),e},changeRowGroupBarItemOrder(e,t){const o=this,r=o.rowGroupBarItems[e],s=o.rowGroupBarItems[t],i=o.rowGroupBarItemColumns[e],a=o.rowGroupBarItemColumns[t];r.querySelector(`.${l}`).innerHTML=a.title,s.querySelector(`.${l}`).innerHTML=i.title,r.classList.remove(n),s.classList.add(n),o.activeRowGroupBarItemEl=s,o.columnDragging.rowGroupBarItemsRect=o.getRowGroupBarItemsRect(),o.columnDragging.changedRowGroupItemOrderIndex=t,o.rowGroupBarItemColumns[e]=a,o.rowGroupBarItemColumns[t]=i}};Object.assign(Grid.prototype,p)})(),(()=>{const{CELL:e,CELL_SELECTION:t,ROW:o,ROW_SELECTED:r,ROW_GROUP:s,ROW_GROUP_CELL_SELECTION:l,INPUT_CHECKBOX:n}=Fancy.cls,i={onRowCellSelectionClick(t){const s=this,l=t.target.closest(`.${e}`),n=Number(l.getAttribute("col-index")),i=l.closest(`.${o}`),a=i.getAttribute("row-id"),d=s.columns[n],c=s.store,u=c.idItemMap.get(a),p=!u.$selected,h=u.$rowGroupValue;c.selectRowItem(u,p),p?i.classList.add(r):i.classList.remove(r),d.headerCheckboxSelection&&s.updateHeaderCheckboxSelection(d),h&&s.updateRowGroupRowsAndCheckBoxes()},onRowGroupCellSelectionClick(e){const t=this,o=e.target.closest(`.${s}`),l=o.getAttribute("row-id"),i=t.store,a=i.idItemMap.get(l),d=!a.$selected,c=a.$rowGroupValue;i.selectGroupRowItems(a,d),d?o.classList.add(r):o.classList.remove(r),t.scroller.columnsViewRange.forEach((e=>{const o=t.columns[e];o.headerCheckboxSelection&&t.updateHeaderCheckboxSelection(o)})),i.groupsChildren[c].forEach((e=>{const o=t.bodyEl.querySelector(`[row-id="${e.id}"]`);if(!o)return;const s=o.querySelector(`.${n}`);d?(o.classList.add(r),s&&(s.checked=!0)):(o.classList.remove(r),s&&(s.checked=!1))})),c&&(t.updateRowGroupRowsAndCheckBoxes(),t.updateRowsAndCheckBoxes())},updateRowGroupRowsAndCheckBoxes(){const e=this.store;this.bodyEl.querySelectorAll(`.${s}`).forEach((t=>{const o=t.getAttribute("row-group").replaceAll("-","/").replaceAll("$","-"),s=t.querySelector(`.${l} .${n}`);switch(e.groupDetails[o].selectedStatus){case!1:t.classList.remove(r),s.indeterminate=!1,s.checked=!1;break;case"full":t.classList.add(r),s.checked=!0,s.indeterminate=!1;break;case"partly":t.classList.remove(r),s.indeterminate=!0}}))},updateRowsAndCheckBoxes(){const e=this.store;this.bodyEl.querySelectorAll(`.${o}`).forEach((o=>{const s=o.getAttribute("row-id"),l=e.idItemMap.get(s);l||console.error(`store.idItemMap does not contain ${s}`);const i=l.$selected,a=o.querySelector(`.${t} .${n}`);i?(o.classList.add(r),a&&(a.checked=!0)):(o.classList.remove(r),a&&(a.indeterminate=!1,a.checked=!1))}))},updateHeaderCheckboxSelection(e){const t=this.store,o=e.headerCheckboxSelectionEl,r=t.selectedItemsMap.size;r?t.getDataTotal()===r?(o.checked=!0,o.indeterminate=!1):o.indeterminate=!0:(o.indeterminate=!1,o.checked=!1)},onHeaderCheckboxSelectionClick(e){const t=this,o=t.store,r=e.target.checked;o.selectAll(r),o.rowGroups.length&&t.updateRowGroupRowsAndCheckBoxes(),t.updateRowsAndCheckBoxes()},getSelection(){const e=this.store,t=[];return e.selectedItemsMap.forEach((e=>{e.$isGroupRow||t.push(e)})),t}};Object.assign(Grid.prototype,i)})(),(()=>{const{ANIMATE_CELLS_POSITION:e,COLUMN_DRAGGING:t,FAKE_COLUMN_CELL_DRAGGING:o,FAKE_COLUMN_CELL_DRAGGING_ALLOW:r,FAKE_COLUMN_CELL_DRAGGING_DENY:s,SVG_ITEM:l,SVG_BLOCK:n,SVG_GROUP:i,SVG_DRAG:a}=Fancy.cls,d={onColumnDragMouseMove(e){const o=this;if(o.columnDragging){const t=o.columnDragging,l=t.dragColumnCellEl,{pageX:n,pageY:i}=e;if(l.style.setProperty("left",n-10+"px"),l.style.setProperty("top",i-10+"px"),o.rowGroupBar&&o.isCursorInRowGroupBar(e,t.rowGroupBarElRect))if(t.inBar){const r=o.isCursorInAnotherRowGroupBarItem(e,t.rowGroupBarItemsRect),s=Number(o.activeRowGroupBarItemEl.getAttribute("row-group-order-index"));void 0!==r&&r!==s&&o.changeRowGroupBarItemOrder(s,r)}else{t.inBar=!0;let n=!1;o.rowGroupBarItemColumns?.forEach((e=>{e.title===t.column.title&&(n=!0)})),n&&!t.dragItemFromRowGroupBar||t.column.$rowGroups?(l.classList.add(s),l.classList.remove(r)):(l.classList.add(r),l.classList.remove(s),t.dragItemFromRowGroupBar||(o.onRowGroupBarMouseEnter(e),o.hideColumn(o.columnDragging.column,!0)))}else t.inBar?(delete t.inBar,t.dragItemFromRowGroupBar?(l.classList.remove(r,s),l.classList.add(r)):(l.classList.contains(s)||(o.showColumn(t.column,!0),o.onRowGroupBarMouseLeave(e)),l.classList.remove(r,s))):(o.debouceColumnDraggingFn||(o.debouceColumnDraggingFn=Fancy.debounce(o.onColumnDragging,50)),o.debouceColumnDraggingFn(e))}else{const r=Math.abs(e.pageX-o.columnDragDownX),s=Math.abs(e.pageY-o.columnDragDownY);if(r>o.deltaStartColumnDrag||s>o.deltaStartColumnDrag){const e=o.columnDragMouseDownColumn;o.columnDragging={column:e,dragColumnCellEl:o.createDragColumnCellEl(e)},o.rowGroupBar&&(o.columnDragging.rowGroupBarItemsRect=o.getRowGroupBarItemsRect()),o.gridEl.classList.add(t),o.rowGroupBar&&(o.columnDragging.rowGroupBarElRect=o.getRowGroupBarElRect())}}},createDragColumnCellEl(e){const t=document.createElement("div"),r=document.createElement("span"),s=e.title;r.innerHTML=s;const d=Fancy.svg.group,c=document.createElement("span");c.classList.add(l,i),c.innerHTML=d;const u=document.createElement("span");u.classList.add(l,a),u.innerHTML=Fancy.svg.groupCellDrag;const p=document.createElement("span");return p.classList.add(l,n),p.innerHTML=Fancy.svg.block,t.appendChild(p),t.appendChild(c),t.appendChild(u),t.appendChild(r),t.classList.add(o,"fg-theme-"+this.theme),document.body.appendChild(t),t},isCursorInRowGroupBar:({pageX:e,pageY:t},o)=>e<o.bottomX&&e>o.x&&t<o.rightY&&t>o.y,isCursorInAnotherRowGroupBarItem({pageX:e},t){if(0!==t.length){for(let o=0,r=t.length;o<r;o++){const r=t[o];if(e>r.x&&e<r.rightX)return o}return e<t[0].x?0:e>t[t.length-1].rightX?t.length-1:void 0}},isCursorInAnotherColumn({pageX:e}){const t=this,o=t.headerEl.getBoundingClientRect(),r=t.scroller.columnsViewRange;e-=o.x;for(let o=0,s=r.length;o<s;o++){const s=r[o],l=t.columns[s];if(e>=l.left&&e<=l.left+l.width)return s}},onColumnDragging(e){const t=this;if(t.animatingColumnsPosition||t.activeRowGroupBarItemEl)return;const o=t.isCursorInAnotherColumn(e);void 0!==o&&t.columnDragMouseDownColumnIndex!==o&&(t.moveColumn(t.columnDragMouseDownColumnIndex,o),t.columnDragMouseDownColumnIndex=o)},moveColumn(t,o){const r=this;r.animatingColumnsPosition=!0,r.gridEl.classList.add(e);const s=r.columns.splice(t,1)[0];r.columns.splice(o,0,s);let l=[];if(r.reSetVisibleHeaderColumnsIndex(),t<o){for(let e=t,r=o;e<=r;e++)l.push(e);const e=l.shift();l.push(e),r.reSetVisibleBodyColumnsIndex(t,o,l)}else{for(let e=o,r=t;e<=r;e++)l.push(e);const e=l.pop();l.unshift(e),r.reSetVisibleBodyColumnsIndex(o,t,l)}r.scroller.generateNewRange(!1),r.reCalcColumnsPositions(),r.updateCellPositions(),setTimeout((()=>{r.gridEl.classList.remove(e),delete r.animatingColumnsPosition}),300)}};Object.assign(Grid.prototype,d)})(),(()=>{const{FILTER_FIELD:e,FILTER_FIELD_INPUT:t,FILTER_FIELD_SIGN:o,FILTER_FIELD_LIST_ITEM:r,FILTER_FIELD_LIST_ITEM_TEXT:s,FILTER_FIELD_LIST:l,FILTER_FIELD_TEXT:n}=Fancy.cls,i={Clear:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z",Contains:"M19,10H5V8H19V10M19,16H5V14H19V16Z","Not Contains":"M21,10H9V8H21V10M21,16H9V14H21V16M4,5H6V16H4V5M6,18V20H4V18H6Z",Equals:"M 10.56 10 L 1.508 10 L 1.508 8 L 10.56 8 L 10.56 10 M 10.56 16 L 1.508 16 L 1.508 14 L 10.56 14 L 10.56 16 Z M 22.009 10.01 L 12.984 10.01 L 12.984 8.01 L 22.009 8.01 L 22.009 10.01 M 22.009 16.01 L 12.984 16.01 L 12.984 14.01 L 22.009 14.01 L 22.009 16.01 Z","Not Equals":"M 12.368 10 L 5.449 10 L 5.449 8 L 12.368 8 L 12.368 10 M 12.368 16 L 5.449 16 L 5.449 14 L 12.368 14 L 12.368 16 Z M 23.009 10.01 L 15.05 10.01 L 15.05 8.01 L 23.009 8.01 L 23.009 10.01 M 23.009 16.01 L 15.05 16.01 L 15.05 14.01 L 23.009 14.01 L 23.009 16.01 Z M 2.585 4.076 L 2.575 13.265 L 0.54 13.277 L 0.55 4.087 L 2.585 4.076 M 6.653 13.252 L 6.621 13.255 L 6.649 13.243 L 6.616 13.239 L 6.653 13.252 Z M 2.569 15.074 L 2.559 17.22 L 0.524 17.223 L 0.534 15.077 L 2.569 15.074 M 6.637 17.217 L 6.605 17.218 L 6.633 17.215 L 6.6 17.214 L 6.637 17.217 Z",Empty:"M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z","Not Empty":"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z","Starts with":"M11.14 4L6.43 16H8.36L9.32 13.43H14.67L15.64 16H17.57L12.86 4M12 6.29L14.03 11.71H9.96M4 18V15H2V20H22V18Z","Ends with":"M11.14 4L6.43 16H8.36L9.32 13.43H14.67L15.64 16H17.57L12.86 4M12 6.29L14.03 11.71H9.96M20 14V18H2V20H22V14Z",Regex:"M16,16.92C15.67,16.97 15.34,17 15,17C14.66,17 14.33,16.97 14,16.92V13.41L11.5,15.89C11,15.5 10.5,15 10.11,14.5L12.59,12H9.08C9.03,11.67 9,11.34 9,11C9,10.66 9.03,10.33 9.08,10H12.59L10.11,7.5C10.3,7.25 10.5,7 10.76,6.76V6.76C11,6.5 11.25,6.3 11.5,6.11L14,8.59V5.08C14.33,5.03 14.66,5 15,5C15.34,5 15.67,5.03 16,5.08V8.59L18.5,6.11C19,6.5 19.5,7 19.89,7.5L17.41,10H20.92C20.97,10.33 21,10.66 21,11C21,11.34 20.97,11.67 20.92,12H17.41L19.89,14.5C19.7,14.75 19.5,15 19.24,15.24V15.24C19,15.5 18.75,15.7 18.5,15.89L16,13.41V16.92H16V16.92M5,19A2,2 0 0,1 7,17A2,2 0 0,1 9,19A2,2 0 0,1 7,21A2,2 0 0,1 5,19H5Z","Greater Than":"M5.5,4.14L4.5,5.86L15,12L4.5,18.14L5.5,19.86L19,12L5.5,4.14Z","Less Than":"M18.5,4.14L19.5,5.86L8.97,12L19.5,18.14L18.5,19.86L5,12L18.5,4.14Z"},a={Clear:"=",Contains:"=","Not Contains":"!=",Equals:"==","Not Equals":"!==",Empty:"empty","Not Empty":"!empty","Starts with":"_a","Ends with":"a_",Regex:"regex","Greater Than":">","Less Than":"<",Positive:"+",Negative:"-"},d={"=":"Clear","=":"Contains","!=":"Not Contains","==":"Equals","!==":"Not Equals",empty:"Empty","!empty":"Not Empty",_a:"Starts with",a_:"Ends with",regex:"Regex",">":"Greater Than","<":"Less Than","+":"Positive","-":"Negative"};Fancy.FilterField=class{sign="=";defaultSign="=";value="";constructor(e){const t=this;Object.assign(t,e),t.render(),t.ons()}render(){const r=this,s=document.createElement("div");r.container=r.renderTo,s.classList.add(e);const l=document.createElement("div");l.classList.add(o),l.innerHTML=['<svg width="17" height="17" viewBox="0 0 24 24" style="vertical-align: middle; fill: currentcolor;">','<path d=""></path>',"</svg>"].join(""),r.elSign=l;const i=document.createElement("input");i.classList.add(t),i.value=r.value,r.input=i;const a=document.createElement("div");a.classList.add(n),r.elText=a,r.updateUI(d[r.sign||r.defaultSign]),s.appendChild(l),s.appendChild(i),s.appendChild(a),r.container.appendChild(s)}ons(){const e=this;e.debouceInputFn=Fancy.debounce(e.onInput.bind(this),300),e.input.addEventListener("input",e.debouceInputFn),e.elSign.addEventListener("click",e.signClick.bind(this))}signClick(){const e=this;e.elComboList?e.destroyComboList():requestAnimationFrame((()=>{e.hideAllOpenedComboList(),e.showComboList()}))}onInput(e){const t=this,o=t.sign||t.defaultSign,r=e.target.value;t.onChange?.(r,o,t.column)}hideAllOpenedComboList(){document.body.querySelectorAll(`.${l}`).forEach((e=>{e.remove()}))}destroyComboList(){this.elComboList?.remove(),delete this.elComboList}showComboList(){const e=this,t=document.createElement("div"),o=e.elSign.getBoundingClientRect(),n=o.top-1+o.height,a=o.left;t.classList.add(l),t.style.top=`${n}px`,t.style.left=`${a}px`;let d=[];switch(e.column.type){case"string":d=["Clear","Contains","Not Contains","Equals","Not Equals","Empty","Not Empty","Starts with","Ends with","Regex"];break;case"number":d=["Clear","Contains","Not Contains","Equals","Not Equals","Empty","Not Empty","Greater Than","Less Than","Positive","Negative"]}t.innerHTML=d.map((e=>{let t=[`<div sign="${e}" class="${r}">`];switch(t.push('<svg width="17" height="17" viewBox="0 0 24 24" style="vertical-align: middle; fill: currentcolor;">'),e){case"Clear":case"Contains":case"Not Contains":case"Equals":case"Not Equals":case"Empty":case"Not Empty":case"Starts with":case"Ends with":case"Regex":case"Greater Than":case"Less Than":t.push(`<path d="${i[e]}"></path>`),t.push("</svg>");break;case"Positive":t.pop(),t.push("&gt;0");break;case"Negative":t.pop(),t.push("&lt;0")}return t.push(`<div class="${s}">${e}</div>`),t.push("</div>"),t.join("")})).join(""),t.addEventListener("click",e.onListClick.bind(this)),document.body.appendChild(t),e.elComboList=t,e.onDocMouseDownFn=e.onDocMouseDown.bind(this),document.addEventListener("mousedown",e.onDocMouseDownFn)}onDocMouseDown(e){const t=this;e.target.closest(`.${l}`)||e.target.closest(`.${o}`)||(document.removeEventListener("mousedown",t.onDocMouseDownFn),t.destroyComboList())}onListClick(e){const t=this,o=e.target.closest(`.${r}`).getAttribute("sign");t.destroyComboList(),t.setSign(o),t.setValue("")}setValue(e){const t=this,o=t.sign||t.defaultSign;switch(o){case"empty":case"!empty":case"+":case"-":e=o;break;default:t.input.value=e}t.onChange?.(e,o,t.column)}setSign(e){this.sign=a[e],this.updateUI(e)}updateUI(e){const t=this;switch(e){case"Clear":case"Contains":case"Not Contains":case"Equals":case"Not Equals":case"Empty":case"Not Empty":case"Starts with":case"Ends with":case"Regex":case"Greater Than":case"Less Than":const o=t.elSign.querySelector("svg d"),r="Clear"===e?i.Contains:i[e];o?o.setAttribute("d",r):t.elSign.innerHTML=['<svg width="17" height="17" viewBox="0 0 24 24" style="vertical-align: middle; fill: currentcolor;">',`<path d="${r}"></path>`,"</svg>"].join("");break;case"Positive":t.elSign.innerHTML="&gt;0";break;case"Negative":t.elSign.innerHTML="&lt;0"}switch(e){case"Empty":case"Not Empty":case"Positive":case"Negative":t.input.style.display="none",t.elText.innerHTML=e,t.elText.style.display="block";break;default:t.input.style.display="",t.elText.style.display="none"}}}})();import"../styles/fg-grid.css";const t=window.Fancy,o=window.Fancy.Grid;export{t as Fancy,o as Grid};
